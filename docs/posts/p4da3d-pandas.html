<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2023-10-11">
<meta name="description" content="Learning notes - Python for Data Analysis, 3E - Wes McKinney">

<title>Albert Joonyoung Park - [5] Pandas</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Albert Joonyoung Park</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text">HOME</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../projects.html" rel="" target="">
 <span class="menu-text">PROJECTS</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../blog.html" rel="" target="">
 <span class="menu-text">BLOG</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">ABOUT</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
    <a href="https://github.com/albert-joonyoung-park" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
    <a href="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-linkedin"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#dataframe" id="toc-dataframe" class="nav-link active" data-scroll-target="#dataframe">DataFrame</a></li>
  <li><a href="#create-a-numpy-structured-array" id="toc-create-a-numpy-structured-array" class="nav-link" data-scroll-target="#create-a-numpy-structured-array">Create a NumPy structured array</a></li>
  <li><a href="#field-type-id-name-age" id="toc-field-type-id-name-age" class="nav-link" data-scroll-target="#field-type-id-name-age">Field + Type: (ID, Name, Age)</a></li>
  <li><a href="#create-a-dataframe-from-the-structued-array" id="toc-create-a-dataframe-from-the-structued-array" class="nav-link" data-scroll-target="#create-a-dataframe-from-the-structued-array">Create a DataFrame from the structued array</a></li>
  <li><a href="#create-a-list-of-dictionaries" id="toc-create-a-list-of-dictionaries" class="nav-link" data-scroll-target="#create-a-list-of-dictionaries">Create a list of dictionaries</a></li>
  <li><a href="#create-a-list-of-series" id="toc-create-a-list-of-series" class="nav-link" data-scroll-target="#create-a-list-of-series">Create a list of Series</a></li>
  <li><a href="#create-a-dataframe-from-the-list-of-dictionaries" id="toc-create-a-dataframe-from-the-list-of-dictionaries" class="nav-link" data-scroll-target="#create-a-dataframe-from-the-list-of-dictionaries">Create a DataFrame from the list of dictionaries</a></li>
  <li><a href="#create-the-original-dataframe" id="toc-create-the-original-dataframe" class="nav-link" data-scroll-target="#create-the-original-dataframe">Create the original DataFrame</a></li>
  <li><a href="#create-a-new-dataframe-based-on-the-original-dataframe" id="toc-create-a-new-dataframe-based-on-the-original-dataframe" class="nav-link" data-scroll-target="#create-a-new-dataframe-based-on-the-original-dataframe">Create a new DataFrame based on the original DataFrame</a>
  <ul class="collapse">
  <li><a href="#index-objects" id="toc-index-objects" class="nav-link" data-scroll-target="#index-objects"><strong>Index Objects</strong></a>
  <ul class="collapse">
  <li><a href="#q-create-an-index-object-and-construct-a-series-using-the-object." id="toc-q-create-an-index-object-and-construct-a-series-using-the-object." class="nav-link" data-scroll-target="#q-create-an-index-object-and-construct-a-series-using-the-object.">Q: Create an Index Object and construct a Series using the object.</a></li>
  <li><a href="#q-create-a-dataframe-and-use-its-index-and-columns-to-test-set-operation-for-element-existence." id="toc-q-create-a-dataframe-and-use-its-index-and-columns-to-test-set-operation-for-element-existence." class="nav-link" data-scroll-target="#q-create-a-dataframe-and-use-its-index-and-columns-to-test-set-operation-for-element-existence.">Q: Create a DataFrame and use its index and columns to test Set operation for element existence.</a></li>
  <li><a href="#q-concatenate-with-additional-index-objects-producing-a-new-index" id="toc-q-concatenate-with-additional-index-objects-producing-a-new-index" class="nav-link" data-scroll-target="#q-concatenate-with-additional-index-objects-producing-a-new-index">Q: Concatenate with additional Index objects, producing a new index</a></li>
  <li><a href="#q-compute-set-difference-intersection-and-union-as-an-index-between-two-index-objects" id="toc-q-compute-set-difference-intersection-and-union-as-an-index-between-two-index-objects" class="nav-link" data-scroll-target="#q-compute-set-difference-intersection-and-union-as-an-index-between-two-index-objects">Q: Compute set difference, intersection and union as an index between two index objects</a></li>
  <li><a href="#q-compute-boolean-array-indicating-whether-each-value-is-contained-in-the-passed-collection" id="toc-q-compute-boolean-array-indicating-whether-each-value-is-contained-in-the-passed-collection" class="nav-link" data-scroll-target="#q-compute-boolean-array-indicating-whether-each-value-is-contained-in-the-passed-collection">Q: Compute Boolean array indicating whether each value is contained in the passed collection</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#create-an-index-object" id="toc-create-an-index-object" class="nav-link" data-scroll-target="#create-an-index-object">Create an Index object</a></li>
  <li><a href="#create-a-collection-of-values-to-check-for-containment" id="toc-create-a-collection-of-values-to-check-for-containment" class="nav-link" data-scroll-target="#create-a-collection-of-values-to-check-for-containment">Create a collection of values to check for containment</a></li>
  <li><a href="#use-the-isin-method-to-check-for-containment" id="toc-use-the-isin-method-to-check-for-containment" class="nav-link" data-scroll-target="#use-the-isin-method-to-check-for-containment">Use the isin() method to check for containment</a></li>
  <li><a href="#display-the-boolean-array-for-each-elements-containment" id="toc-display-the-boolean-array-for-each-elements-containment" class="nav-link" data-scroll-target="#display-the-boolean-array-for-each-elements-containment">Display the Boolean array for each element’s containment</a>
  <ul class="collapse">
  <li><a href="#question-create-a-new-index-object-by-deleting-passed-lables-from-the-index." id="toc-question-create-a-new-index-object-by-deleting-passed-lables-from-the-index." class="nav-link" data-scroll-target="#question-create-a-new-index-object-by-deleting-passed-lables-from-the-index.">Question: Create a new Index object by deleting passed lables from the index.</a></li>
  <li><a href="#question-create-a-new-index-object-by-inserting-new-labels-to-an-existing-index-object-after-the-element-matching-with-the-first-letter-of-the-new-label" id="toc-question-create-a-new-index-object-by-inserting-new-labels-to-an-existing-index-object-after-the-element-matching-with-the-first-letter-of-the-new-label" class="nav-link" data-scroll-target="#question-create-a-new-index-object-by-inserting-new-labels-to-an-existing-index-object-after-the-element-matching-with-the-first-letter-of-the-new-label">Question: Create a new Index object by inserting new labels to an existing Index object, after the element matching with the first letter of the new label</a></li>
  <li><a href="#question-you-have-a-pandas-index-object-and-you-want-to-check-if-it-is-monotonically-decreasing.-write-a-python-function-that-takes-an-index-object-as-input-and-returns-true-if-the-index-is-monotonically-decreasing-and-false-otherwise." id="toc-question-you-have-a-pandas-index-object-and-you-want-to-check-if-it-is-monotonically-decreasing.-write-a-python-function-that-takes-an-index-object-as-input-and-returns-true-if-the-index-is-monotonically-decreasing-and-false-otherwise." class="nav-link" data-scroll-target="#question-you-have-a-pandas-index-object-and-you-want-to-check-if-it-is-monotonically-decreasing.-write-a-python-function-that-takes-an-index-object-as-input-and-returns-true-if-the-index-is-monotonically-decreasing-and-false-otherwise.">Question: You have a Pandas Index object, and you want to check if it is monotonically decreasing. Write a Python function that takes an Index object as input and returns <strong><code>True</code></strong> if the index is monotonically decreasing, and <strong><code>False</code></strong> otherwise.</a></li>
  <li><a href="#question-you-have-a-pandas-index-object-and-you-want-to-check-if-it-contains-unique-elements.-write-a-python-function-that-takes-an-index-object-as-input-and-returns-true-if-all-the-elements-are-unique-and-false-otherwise." id="toc-question-you-have-a-pandas-index-object-and-you-want-to-check-if-it-contains-unique-elements.-write-a-python-function-that-takes-an-index-object-as-input-and-returns-true-if-all-the-elements-are-unique-and-false-otherwise." class="nav-link" data-scroll-target="#question-you-have-a-pandas-index-object-and-you-want-to-check-if-it-contains-unique-elements.-write-a-python-function-that-takes-an-index-object-as-input-and-returns-true-if-all-the-elements-are-unique-and-false-otherwise.">Question: You have a Pandas Index object, and you want to check if it contains unique elements. Write a Python function that takes an Index object as input and returns <code>True</code> if all the elements are unique, and <code>False</code> otherwise.</a></li>
  <li><a href="#you-have-a-pandas-index-object-and-you-want-to-retrieve-the-unique-elements-from-it.-write-a-python-function-that-takes-an-index-object-as-input-and-returns-a-list-of-unique-elements-from-the-index." id="toc-you-have-a-pandas-index-object-and-you-want-to-retrieve-the-unique-elements-from-it.-write-a-python-function-that-takes-an-index-object-as-input-and-returns-a-list-of-unique-elements-from-the-index." class="nav-link" data-scroll-target="#you-have-a-pandas-index-object-and-you-want-to-retrieve-the-unique-elements-from-it.-write-a-python-function-that-takes-an-index-object-as-input-and-returns-a-list-of-unique-elements-from-the-index.">You have a Pandas Index object, and you want to retrieve the unique elements from it. Write a Python function that takes an Index object as input and returns a list of unique elements from the index.</a></li>
  <li><a href="#the-mechanics-of-interacting-with-data-in-series-and-dataframe" id="toc-the-mechanics-of-interacting-with-data-in-series-and-dataframe" class="nav-link" data-scroll-target="#the-mechanics-of-interacting-with-data-in-series-and-dataframe">The mechanics of interacting with data in Series and DataFrame</a>
  <ul class="collapse">
  <li><a href="#question-youre-working-with-a-dataset-of-daily-stock-prices-for-a-portfolio-of-companies.-the-dataset-has-missing-values-for-certain-days-and-you-want-to-reindex-it-to-ensure-you-have-a-complete-set-of-daily-data-for-a-specified-date-range.-you-need-to-create-a-python-function-that-takes-several-arguments-to-demonstrate-the-use-of-the-reindex-method-and-its-optional-parameters.-your-task-is-to-implement-the-reindex_stock_data-function-which-demonstrates-the-use-of-these-parameters.-the-function-should-reindex-the-stock-price-data-to-the-specified-date-range-filling-missing-data-with-the-provided-fill_value-and-considering-the-other-optional-parameters." id="toc-question-youre-working-with-a-dataset-of-daily-stock-prices-for-a-portfolio-of-companies.-the-dataset-has-missing-values-for-certain-days-and-you-want-to-reindex-it-to-ensure-you-have-a-complete-set-of-daily-data-for-a-specified-date-range.-you-need-to-create-a-python-function-that-takes-several-arguments-to-demonstrate-the-use-of-the-reindex-method-and-its-optional-parameters.-your-task-is-to-implement-the-reindex_stock_data-function-which-demonstrates-the-use-of-these-parameters.-the-function-should-reindex-the-stock-price-data-to-the-specified-date-range-filling-missing-data-with-the-provided-fill_value-and-considering-the-other-optional-parameters." class="nav-link" data-scroll-target="#question-youre-working-with-a-dataset-of-daily-stock-prices-for-a-portfolio-of-companies.-the-dataset-has-missing-values-for-certain-days-and-you-want-to-reindex-it-to-ensure-you-have-a-complete-set-of-daily-data-for-a-specified-date-range.-you-need-to-create-a-python-function-that-takes-several-arguments-to-demonstrate-the-use-of-the-reindex-method-and-its-optional-parameters.-your-task-is-to-implement-the-reindex_stock_data-function-which-demonstrates-the-use-of-these-parameters.-the-function-should-reindex-the-stock-price-data-to-the-specified-date-range-filling-missing-data-with-the-provided-fill_value-and-considering-the-other-optional-parameters.">Question: You’re working with a dataset of daily stock prices for a portfolio of companies. The dataset has missing values for certain days, and you want to reindex it to ensure you have a complete set of daily data for a specified date range. You need to create a Python function that takes several arguments to demonstrate the use of the reindex() method and its optional parameters. Your task is to implement the reindex_stock_data() function, which demonstrates the use of these parameters. The function should reindex the stock price data to the specified date range, filling missing data with the provided fill_value and considering the other optional parameters.</a></li>
  </ul></li>
  <li><a href="#question-create-a-dataframe-called-sales_data-that-contains-sales-data-for-various-products-in-different-stores.-use-the-sales_data-and-create-dataframes-below." id="toc-question-create-a-dataframe-called-sales_data-that-contains-sales-data-for-various-products-in-different-stores.-use-the-sales_data-and-create-dataframes-below." class="nav-link" data-scroll-target="#question-create-a-dataframe-called-sales_data-that-contains-sales-data-for-various-products-in-different-stores.-use-the-sales_data-and-create-dataframes-below.">Question: Create a DataFrame called ‘sales_data’ that contains sales data for various products in different stores. Use the ‘sales_data’ and create DataFrames below.</a>
  <ul class="collapse">
  <li><a href="#dropping-entries-from-an-axis" id="toc-dropping-entries-from-an-axis" class="nav-link" data-scroll-target="#dropping-entries-from-an-axis">Dropping Entries from an Axis</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">[5] Pandas</h1>
<p class="subtitle lead">A series of posts, exploring data analysis using the book - Python for Data Analysis, 3E by Wes McKinney</p>
  <div class="quarto-categories">
    <div class="quarto-category">Python</div>
    <div class="quarto-category">pandas</div>
  </div>
  </div>

<div>
  <div class="description">
    Learning notes - Python for Data Analysis, 3E - Wes McKinney
  </div>
</div>


<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 11, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<hr>
<p><strong>pandas is ….</strong></p>
<p>Two workhorse data structures: Series and DataFrame, solid foundation of wide variety of data tasks.</p>
<p>Series - one-dimensional array-like object with a sequence of values and index: array + lables</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simple Series</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>obj <span class="op">=</span> pd.Series([<span class="dv">4</span>, <span class="dv">7</span>, <span class="op">-</span><span class="dv">5</span>, <span class="dv">3</span>])</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(obj)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(obj))</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(obj.array)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(obj.index)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># A Series with a custom index</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>obj2 <span class="op">=</span> pd.Series([<span class="dv">4</span>, <span class="dv">7</span>, <span class="op">-</span><span class="dv">5</span>, <span class="dv">3</span>], index<span class="op">=</span>[<span class="st">"d"</span>, <span class="st">"b"</span>, <span class="st">"a"</span>, <span class="st">"c"</span>])</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(obj2)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(obj2.index)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Select, modify array elemtns using index</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>obj2[<span class="st">"a"</span>]</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>obj2[<span class="st">"d"</span>] <span class="op">=</span> <span class="dv">6</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>obj2[[<span class="st">"c"</span>, <span class="st">"a"</span>, <span class="st">"d"</span>]]  <span class="co"># using a list of 'indices'-like</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Preservation of index-value link</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(obj2[obj2 <span class="op">&gt;</span> <span class="dv">0</span>])</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(obj2 <span class="op">*</span> <span class="dv">2</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.exp(obj2))</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Series and dictionary, the shared context: mapping of index value to data value</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"b"</span> <span class="kw">in</span> obj2)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"B"</span> <span class="kw">in</span> obj2)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert Python dictionary to/from a Series</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>data_dict <span class="op">=</span> {</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">"name"</span>: <span class="st">"John Smith"</span>,</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">"age"</span>: <span class="dv">30</span>,</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">"city"</span>: <span class="st">"New York"</span>,</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">"email"</span>: <span class="st">"john.smith@email.com"</span>,</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">"is_student"</span>: <span class="va">False</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data_dict)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>s_data <span class="op">=</span> pd.Series(data_dict)  <span class="co"># dictionary to Series</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(s_data, <span class="bu">type</span>(s_data))</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>d_data <span class="op">=</span> s_data.to_dict()  <span class="co"># Series to dictionary</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(d_data, <span class="bu">type</span>(d_data))</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Preservation of index-value</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>new_index <span class="op">=</span> [<span class="st">"gender"</span>, <span class="st">"name"</span>, <span class="st">"age"</span>, <span class="st">"city"</span>, <span class="st">"email"</span>]</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>obj4 <span class="op">=</span> pd.Series(data_dict, index<span class="op">=</span>new_index)</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(obj4)</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Detecting missing data using pd and Series</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pd.isna(obj4))</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pd.notna(obj4))</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(obj4.isna())</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(obj4.notna())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0    4
1    7
2   -5
3    3
dtype: int64
&lt;class 'pandas.core.series.Series'&gt;
&lt;PandasArray&gt;
[4, 7, -5, 3]
Length: 4, dtype: int64
RangeIndex(start=0, stop=4, step=1)
d    4
b    7
a   -5
c    3
dtype: int64
Index(['d', 'b', 'a', 'c'], dtype='object')
d    6
b    7
c    3
dtype: int64
d    12
b    14
a   -10
c     6
dtype: int64
d     403.428793
b    1096.633158
a       0.006738
c      20.085537
dtype: float64
True
False
{'name': 'John Smith', 'age': 30, 'city': 'New York', 'email': 'john.smith@email.com', 'is_student': False}
name                    John Smith
age                             30
city                      New York
email         john.smith@email.com
is_student                   False
dtype: object &lt;class 'pandas.core.series.Series'&gt;
{'name': 'John Smith', 'age': 30, 'city': 'New York', 'email': 'john.smith@email.com', 'is_student': False} &lt;class 'dict'&gt;
gender                     NaN
name                John Smith
age                         30
city                  New York
email     john.smith@email.com
dtype: object
gender     True
name      False
age       False
city      False
email     False
dtype: bool
gender    False
name       True
age        True
city       True
email      True
dtype: bool
gender     True
name      False
age       False
city      False
email     False
dtype: bool
gender    False
name       True
age        True
city       True
email      True
dtype: bool</code></pre>
</div>
</div>
<p><strong>Q: How to assign a name to a pandas Series and customize its index name?</strong></p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>sdata <span class="op">=</span> {<span class="st">"Ohio"</span>: <span class="dv">35000</span>, <span class="st">"Texas"</span>: <span class="dv">71000</span>, <span class="st">"Oregon"</span>: <span class="dv">16000</span>, <span class="st">"Utah"</span>: <span class="dv">5000</span>}</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>states <span class="op">=</span> [<span class="st">"California"</span>, <span class="st">"Ohio"</span>, <span class="st">"Oregon"</span>, <span class="st">"Texas"</span>]</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>obj4 <span class="op">=</span> pd.Series(sdata, index<span class="op">=</span>states)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(obj4)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>obj4.name <span class="op">=</span> <span class="st">"population"</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>obj4.index.name <span class="op">=</span> <span class="st">"state"</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(obj4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>California        NaN
Ohio          35000.0
Oregon        16000.0
Texas         71000.0
dtype: float64
state
California        NaN
Ohio          35000.0
Oregon        16000.0
Texas         71000.0
Name: population, dtype: float64</code></pre>
</div>
</div>
<p>Q: Change the index of Series in place</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># change the index using index attribute</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>obj.index <span class="op">=</span> [<span class="st">"One"</span>, <span class="st">"Two"</span>, <span class="st">"Three"</span>, <span class="st">"Four"</span>]</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(obj)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>One      4
Two      7
Three   -5
Four     3
dtype: int64</code></pre>
</div>
</div>
<section id="dataframe" class="level3">
<h3 class="anchored" data-anchor-id="dataframe">DataFrame</h3>
<p>Rectangular table of data, ordered, named collection of columns. Each column can be a different value type. It has both a row and column index - A dictionary of Series</p>
<p><strong>Q. Create a DataFrame from a dictionary of equal-length lists or Numpy arrays</strong></p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># most common way of creating a DataFrame</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {<span class="st">"state"</span>: [<span class="st">"Ohio"</span>, <span class="st">"Ohio"</span>, <span class="st">"Ohio"</span>, <span class="st">"Nevada"</span>, <span class="st">"Nevada"</span>, <span class="st">"Nevada"</span>],</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"year"</span>: [<span class="dv">2000</span>, <span class="dv">2001</span>, <span class="dv">2002</span>, <span class="dv">2001</span>, <span class="dv">2002</span>, <span class="dv">2003</span>],</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"pop"</span>: [<span class="fl">1.5</span>, <span class="fl">1.7</span>, <span class="fl">3.6</span>, <span class="fl">2.4</span>, <span class="fl">2.9</span>, <span class="fl">3.2</span>]}</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>frame <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(frame)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(frame.head())</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(frame.tail())</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(frame.columns.array)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(frame.index.array)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    state  year  pop
0    Ohio  2000  1.5
1    Ohio  2001  1.7
2    Ohio  2002  3.6
3  Nevada  2001  2.4
4  Nevada  2002  2.9
5  Nevada  2003  3.2
    state  year  pop
0    Ohio  2000  1.5
1    Ohio  2001  1.7
2    Ohio  2002  3.6
3  Nevada  2001  2.4
4  Nevada  2002  2.9
    state  year  pop
1    Ohio  2001  1.7
2    Ohio  2002  3.6
3  Nevada  2001  2.4
4  Nevada  2002  2.9
5  Nevada  2003  3.2
&lt;PandasArray&gt;
['state', 'year', 'pop']
Length: 3, dtype: object
&lt;PandasArray&gt;
[0, 1, 2, 3, 4, 5]
Length: 6, dtype: int64</code></pre>
</div>
</div>
<p><strong>Q: Create a DataFrame in a customized sequence of columns</strong></p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a DataFrame in a custom column order - default is by the order of key value</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>frame2 <span class="op">=</span> pd.DataFrame(data, columns<span class="op">=</span>[<span class="st">"year"</span>, <span class="st">"state"</span>, <span class="st">"pop"</span>, <span class="st">"debt"</span>])</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(frame2)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(frame2.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   year   state  pop debt
0  2000    Ohio  1.5  NaN
1  2001    Ohio  1.7  NaN
2  2002    Ohio  3.6  NaN
3  2001  Nevada  2.4  NaN
4  2002  Nevada  2.9  NaN
5  2003  Nevada  3.2  NaN
Index(['year', 'state', 'pop', 'debt'], dtype='object')</code></pre>
</div>
</div>
<p><strong>Q: Retrieve columns in a DataFrame</strong></p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Retrieve columns using [] or dot notation</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(frame2[<span class="st">"state"</span>])</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(frame2.state)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0      Ohio
1      Ohio
2      Ohio
3    Nevada
4    Nevada
5    Nevada
Name: state, dtype: object
0      Ohio
1      Ohio
2      Ohio
3    Nevada
4    Nevada
5    Nevada
Name: state, dtype: object</code></pre>
</div>
</div>
<p>Q: Retrieve rows using row labels and integer</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data source dictionary</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {<span class="st">'A'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>],</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">'B'</span>: [<span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>]}</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># DataFrame</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data, index<span class="op">=</span>[<span class="st">'row1'</span>, <span class="st">'row2'</span>, <span class="st">'row3'</span>, <span class="st">'row4'</span>, <span class="st">'row5'</span>])</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Label-based selection</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.loc[<span class="st">'row1'</span>:<span class="st">'row3'</span>])</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Integer-based selection</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.iloc[<span class="dv">0</span>:<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      A   B
row1  1   6
row2  2   7
row3  3   8
row4  4   9
row5  5  10
      A  B
row1  1  6
row2  2  7
row3  3  8
      A  B
row1  1  6
row2  2  7</code></pre>
</div>
</div>
<p><strong>Q: Modify the ‘debt’ column in the DataFrame with a specific scalar value or an array of values</strong></p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>frame2[<span class="st">"debt"</span>] <span class="op">=</span> <span class="fl">16.5</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(frame2)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>frame2[<span class="st">"debt"</span>] <span class="op">=</span> np.arange(<span class="fl">6.</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(frame2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   year   state  pop  debt
0  2000    Ohio  1.5  16.5
1  2001    Ohio  1.7  16.5
2  2002    Ohio  3.6  16.5
3  2001  Nevada  2.4  16.5
4  2002  Nevada  2.9  16.5
5  2003  Nevada  3.2  16.5
   year   state  pop  debt
0  2000    Ohio  1.5   0.0
1  2001    Ohio  1.7   1.0
2  2002    Ohio  3.6   2.0
3  2001  Nevada  2.4   3.0
4  2002  Nevada  2.9   4.0
5  2003  Nevada  3.2   5.0</code></pre>
</div>
</div>
<p>Q: <strong>Modify the ‘debt’ column in the DataFrame with a Series object with different number of data</strong></p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Series index value is used to match the index of DataFrame, if not presented, it is ignored</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>val <span class="op">=</span> pd.Series([<span class="op">-</span><span class="fl">1.2</span>, <span class="op">-</span><span class="fl">1.5</span>, <span class="op">-</span><span class="fl">1.7</span>], index<span class="op">=</span>[<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">32</span>])</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>frame2[<span class="st">"debt"</span>] <span class="op">=</span> val</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(frame2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   year   state  pop  debt
0  2000    Ohio  1.5   NaN
1  2001    Ohio  1.7   NaN
2  2002    Ohio  3.6  -1.2
3  2001  Nevada  2.4   NaN
4  2002  Nevada  2.9  -1.5
5  2003  Nevada  3.2   NaN</code></pre>
</div>
</div>
<p><strong>Q: Create a column called <em><code>eastern</code></em>, and initialize it with Boolean value if the state is <em><code>Ohio</code></em></strong></p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>frame2[<span class="st">"eastern"</span>] <span class="op">=</span> (frame2[<span class="st">"state"</span>] <span class="op">==</span> <span class="st">"Ohio"</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(frame2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   year   state  pop  debt  eastern
0  2000    Ohio  1.5   NaN     True
1  2001    Ohio  1.7   NaN     True
2  2002    Ohio  3.6  -1.2     True
3  2001  Nevada  2.4   NaN    False
4  2002  Nevada  2.9  -1.5    False
5  2003  Nevada  3.2   NaN    False</code></pre>
</div>
</div>
<p><strong>Q: Delete column <em><code>eastern</code></em> and list all the columns for the DataFrame</strong></p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">del</span> frame2[<span class="st">"eastern"</span>]</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>frame2.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>Index(['year', 'state', 'pop', 'debt'], dtype='object')</code></pre>
</div>
</div>
<p><strong>Q: Create a DataFrame using a nested dictionary data.</strong></p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>populations <span class="op">=</span> {<span class="st">"Ohio"</span>: {<span class="dv">2000</span>: <span class="fl">1.5</span>, <span class="dv">2001</span>: <span class="fl">1.7</span>, <span class="dv">2002</span>: <span class="fl">3.6</span>},</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>               <span class="st">"Nevada"</span>: {<span class="dv">2001</span>: <span class="fl">2.4</span>, <span class="dv">2002</span>: <span class="fl">2.9</span>}}</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(populations)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># outer dictionary key - column indices</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>df_populations <span class="op">=</span> pd.DataFrame(populations)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_populations)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{'Ohio': {2000: 1.5, 2001: 1.7, 2002: 3.6}, 'Nevada': {2001: 2.4, 2002: 2.9}}
      Ohio  Nevada
2000   1.5     NaN
2001   1.7     2.4
2002   3.6     2.9</code></pre>
</div>
</div>
<p><strong>Q: Transpose the df_populations DataFrame.</strong></p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>df_populations.T</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">2000</th>
<th data-quarto-table-cell-role="th">2001</th>
<th data-quarto-table-cell-role="th">2002</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Ohio</td>
<td>1.5</td>
<td>1.7</td>
<td>3.6</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Nevada</td>
<td>NaN</td>
<td>2.4</td>
<td>2.9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><strong>Q: Create a DataFrame using a nested dictionary data, using new column index</strong></p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(populations, index<span class="op">=</span>[<span class="dv">2000</span>, <span class="dv">2001</span>, <span class="dv">2012</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Ohio</th>
<th data-quarto-table-cell-role="th">Nevada</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2000</td>
<td>1.5</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2001</td>
<td>1.7</td>
<td>2.4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2012</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Q. Create a DataFrame using frame3, using a dictionary with a few Series of columns with custom range</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>sub_populations <span class="op">=</span> {</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ohio2"</span>: df_populations[<span class="st">"Ohio"</span>][:<span class="op">-</span><span class="dv">1</span>],</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nevada2"</span>: df_populations[<span class="st">"Nevada"</span>][:<span class="dv">2</span>]</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>df_sub_populations <span class="op">=</span> pd.DataFrame(sub_populations)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_sub_populations)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Ohio2  Nevada2
2000    1.5      NaN
2001    1.7      2.4</code></pre>
</div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>populations</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>{'Ohio': {2000: 1.5, 2001: 1.7, 2002: 3.6}, 'Nevada': {2001: 2.4, 2002: 2.9}}</code></pre>
</div>
</div>
<p><strong>Q: Create a DataFrame using a NumPy 2D-array. Give custom row and column labels</strong></p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a 2D ndarray as data source</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>,],</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>                [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>],</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>                [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]])</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Define custom row and column labels</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>row_labels <span class="op">=</span> [<span class="st">'Row-1'</span>, <span class="st">'Row-2'</span>, <span class="st">'Row-3'</span>]</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>column_labels <span class="op">=</span> [<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>]</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame with the custom labels</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data, index<span class="op">=</span>row_labels, columns<span class="op">=</span>column_labels)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       A  B  C
Row-1  1  2  3
Row-2  4  5  6
Row-3  7  8  9</code></pre>
</div>
</div>
<p><strong>Q: Create a DataFrame using a dictionary of arrays, lists or tuples.</strong></p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DataFrame from a dictionary</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dictionary with arrays</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>data_dict <span class="op">=</span> {</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Name'</span>: np.array([<span class="st">'Alice'</span>, <span class="st">'Bob'</span>, <span class="st">'Charlie'</span>]),</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Age'</span>: np.array([<span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">28</span>]),</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'City'</span>: np.array([<span class="st">'Toronto'</span>, <span class="st">'Calgary'</span>, <span class="st">'Ottawa'</span>])</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a pandas DataFrame</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data_dict)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Name  Age     City
0    Alice   25  Toronto
1      Bob   30  Calgary
2  Charlie   28   Ottawa</code></pre>
</div>
</div>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DataFrame from a list</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dictionary with lists</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>data_dict <span class="op">=</span> {</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Country'</span>: [<span class="st">'USA'</span>, <span class="st">'Canada'</span>, <span class="st">'UK'</span>],</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Population'</span>: [<span class="dv">328</span>, <span class="dv">38</span>, <span class="dv">66</span>],</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Capital'</span>: [<span class="st">'Washington D.C.'</span>, <span class="st">'Ottawa'</span>, <span class="st">'London'</span>]</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a pandas DataFrame</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data_dict)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Country  Population          Capital
0     USA         328  Washington D.C.
1  Canada          38           Ottawa
2      UK          66           London</code></pre>
</div>
</div>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dictionary with tuples</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>data_dict <span class="op">=</span> {</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Fruit'</span>: (<span class="st">'Apple'</span>, <span class="st">'Banana'</span>, <span class="st">'Cherry'</span>),</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Color'</span>: (<span class="st">'Red'</span>, <span class="st">'Yellow'</span>, <span class="st">'Red'</span>),</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Taste'</span>: (<span class="st">'Sweet'</span>, <span class="st">'Sweet'</span>, <span class="st">'Tart'</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a pandas DataFrame</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data_dict)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Fruit   Color  Taste
0   Apple     Red  Sweet
1  Banana  Yellow  Sweet
2  Cherry     Red   Tart</code></pre>
</div>
</div>
<p><strong>Q: Create a DataFrame using a NumPy structured array</strong></p>
<p>`</p>
</section>
<section id="create-a-numpy-structured-array" class="level1">
<h1>Create a NumPy structured array</h1>
</section>
<section id="field-type-id-name-age" class="level1">
<h1>Field + Type: (ID, Name, Age)</h1>
<p>data = np.array([(100, ‘Alice’, 25), (200, ‘Bob’, 30), (300, ‘Charlie’, 29)], dtype=[(‘ID’, int), (‘Name’, ‘U10’), (‘Age’, int)])</p>
</section>
<section id="create-a-dataframe-from-the-structued-array" class="level1">
<h1>Create a DataFrame from the structued array</h1>
<p>df = pd.DataFrame(data) print(df)</p>
<pre><code>
**Q:** **Create a DataFrame using a dictionary of Series.**

::: {.cell execution_count=21}
``` {.python .cell-code}
# Create a dictioinary of Series
data_dict = {
    'Name': pd.Series(['Alice', 'Bob', 'Charlie']),
    'Age': pd.Series([25, 30, 28]),
    'City': pd.Series(['New York', 'San Francisco', 'Los Angeles', 'Paris'])
}

# Create a pandas DataFrame from the dictioanry of Series
df = pd.DataFrame(data_dict)
print(df)</code></pre>
<div class="cell-output cell-output-stdout">
<pre><code>      Name   Age           City
0    Alice  25.0       New York
1      Bob  30.0  San Francisco
2  Charlie  28.0    Los Angeles
3      NaN   NaN          Paris</code></pre>
</div>
<p>:::</p>
<p><strong>Q:</strong> <strong>Create a DataFrame using a list of dictionaries / Series.</strong></p>
<p>`</p>
</section>
<section id="create-a-list-of-dictionaries" class="level1">
<h1>Create a list of dictionaries</h1>
<p>data_dict = [ {‘Name’: ‘Alice’, ‘Age’: 25, ‘City’: ‘New York’}, {‘Name’: ‘Bob’, ‘Age’: 30, ‘City’: ‘San Francisco’}, {‘Name’: ‘Charlie’, ‘Age’: 28, ‘City’: ‘Los Angeles’}]</p>
</section>
<section id="create-a-list-of-series" class="level1">
<h1>Create a list of Series</h1>
<p>name_series = pd.Series([‘Alice’, ‘Bob’, ‘Charlie’], name=‘Name’) age_series = pd.Series([25, 30, 28], name=‘Age’) city_series = pd.Series( [‘New York’, ‘San Francisco’, ‘Los Angeles’], name=‘City’)</p>
</section>
<section id="create-a-dataframe-from-the-list-of-dictionaries" class="level1">
<h1>Create a DataFrame from the list of dictionaries</h1>
<p>df1 = pd.DataFrame(data_dict) print(df1) print(“-” * 50) # Create a DataFrame from the list of Series df2 = pd.DataFrame({‘Name’: name_series, ‘Age’: age_series, ‘City’: city_series}) print(df2)</p>
<pre><code>
**Q: Create a DataFrame using a list of lists / tuples**

`


# Create a list of lists
data_list = [
    ['Alice', 25, 'New York'],
    ['Bob', 30, 'San Francisco'],
    ['Charlie', 28, 'Los Angeles']
]

# Define column labels
columns = ['Name', 'Age', 'City']

# Create a DataFrame from the list of lists
df = pd.DataFrame(data_list, columns=columns)
print(df)

print("-" * 50)

# Create a list of tuples
data_tuples = [
    ('Alice', 25, 'New York'),
    ('Bob', 30, 'San Francisco'),
    ('Charlie', 28, 'Los Angeles')
]

# Define column labels
columns = ['name', 'age', 'city']

# Create a DataFrame from the list of tuples
df = pd.DataFrame(data_tuples, columns=columns)
print(df)</code></pre>
<p><strong>Q: Create a DataFrame using another DataFrame</strong></p>
<p>`</p>
</section>
<section id="create-the-original-dataframe" class="level1">
<h1>Create the original DataFrame</h1>
<p>data = { ‘Name’: [‘Alice’, ‘Bob’, ‘Charlie’], ‘Age’: [25, 30, 28], ‘City’: [‘New York’, ‘San Francisco’, ‘Los Angeles’] }</p>
<p>original_df = pd.DataFrame(data) print(original_df) print(“-” * 50)</p>
</section>
<section id="create-a-new-dataframe-based-on-the-original-dataframe" class="level1">
<h1>Create a new DataFrame based on the original DataFrame</h1>
<p>copy_original_df = original_df.copy() copy_original_df.columns = [’_name’, ’_age’, ’_city’] print(copy_original_df) print(“-” * 50)</p>
<p>new_df = pd.DataFrame(original_df) print(new_df) print(“-” * 50)</p>
<p>print(id(original_df)) print(id(copy_original_df)) print(id(new_df))</p>
<pre><code>
**Q: Create a DataFrame and update the name attributes for index and columns**

::: {.cell execution_count=22}
``` {.python .cell-code}
# Data source in a idctionary
populations = {
    "Ohio": {2000: 1.5, 2001: 1.7, 2002: 3.6},
    "Nevada": {2001: 2.4, 2002: 2.9}
}

# Create a DataFrame
frame3 = pd.DataFrame(populations)
print(frame3)
print("-" * 50)

# Update the name attributes for index / columns
frame3.index.name = "year"
frame3.columns.name = "state"
print(frame3)</code></pre>
<div class="cell-output cell-output-stdout">
<pre><code>      Ohio  Nevada
2000   1.5     NaN
2001   1.7     2.4
2002   3.6     2.9
--------------------------------------------------
state  Ohio  Nevada
year               
2000    1.5     NaN
2001    1.7     2.4
2002    3.6     2.9</code></pre>
</div>
<p>:::</p>
<p><strong>Q. Create a DataFrame from a dictionary, then convert it to a NumPy array.</strong></p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data source in a dictionary</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"state"</span>: [<span class="st">"Ohio"</span>, <span class="st">"Ohio"</span>, <span class="st">"Ohio"</span>, <span class="st">"Nevada"</span>, <span class="st">"Nevada"</span>, <span class="st">"Nevada"</span>],</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"year"</span>: [<span class="dv">2000</span>, <span class="dv">2001</span>, <span class="dv">2002</span>, <span class="dv">2001</span>, <span class="dv">2002</span>, <span class="dv">2003</span>],</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"pop"</span>: [<span class="fl">1.5</span>, <span class="fl">1.7</span>, <span class="fl">3.6</span>, <span class="fl">2.4</span>, <span class="fl">2.9</span>, <span class="fl">3.2</span>]</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data, <span class="bu">type</span>(data))</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span><span class="op">*</span><span class="dv">50</span>)</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame and add a column 'debt'</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>frame2 <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>val <span class="op">=</span> pd.Series([<span class="op">-</span><span class="fl">1.2</span>, <span class="op">-</span><span class="fl">1.5</span>, <span class="op">-</span><span class="fl">1.7</span>], index<span class="op">=</span>[<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>])</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>frame2[<span class="st">"debt"</span>] <span class="op">=</span> val</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(frame2, <span class="bu">type</span>(frame2))</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span><span class="op">*</span><span class="dv">50</span>)</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert DataFrame to NuPy 2d-ndarray</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>frame2_array <span class="op">=</span> frame2.to_numpy()</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(frame2_array, <span class="bu">type</span>(frame2_array))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{'state': ['Ohio', 'Ohio', 'Ohio', 'Nevada', 'Nevada', 'Nevada'], 'year': [2000, 2001, 2002, 2001, 2002, 2003], 'pop': [1.5, 1.7, 3.6, 2.4, 2.9, 3.2]} &lt;class 'dict'&gt;
--------------------------------------------------
    state  year  pop  debt
0    Ohio  2000  1.5   NaN
1    Ohio  2001  1.7   NaN
2    Ohio  2002  3.6  -1.2
3  Nevada  2001  2.4   NaN
4  Nevada  2002  2.9  -1.5
5  Nevada  2003  3.2  -1.7 &lt;class 'pandas.core.frame.DataFrame'&gt;
--------------------------------------------------
[['Ohio' 2000 1.5 nan]
 ['Ohio' 2001 1.7 nan]
 ['Ohio' 2002 3.6 -1.2]
 ['Nevada' 2001 2.4 nan]
 ['Nevada' 2002 2.9 -1.5]
 ['Nevada' 2003 3.2 -1.7]] &lt;class 'numpy.ndarray'&gt;</code></pre>
</div>
</div>
<section id="index-objects" class="level2">
<h2 class="anchored" data-anchor-id="index-objects"><strong>Index Objects</strong></h2>
<p>Index objects holds the information about axis labels (labels assigned to rows and columns in DataFrame and Series) and meta data. Index objects are immutable and it makes it safer to share index objects among data structures.</p>
<p>Q: Construct a Series object and retrieve index information from it.</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a Series</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>obj <span class="op">=</span> pd.Series(np.arange(<span class="dv">3</span>), index<span class="op">=</span>[<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>])  <span class="co"># row labels</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(obj, <span class="bu">type</span>(obj))</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(obj.index)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(obj.index[<span class="dv">1</span>:])  <span class="co"># slicing the array of index object</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>a    0
b    1
c    2
dtype: int32 &lt;class 'pandas.core.series.Series'&gt;
Index(['a', 'b', 'c'], dtype='object')
Index(['b', 'c'], dtype='object')</code></pre>
</div>
</div>
<section id="q-create-an-index-object-and-construct-a-series-using-the-object." class="level3">
<h3 class="anchored" data-anchor-id="q-create-an-index-object-and-construct-a-series-using-the-object.">Q: Create an Index Object and construct a Series using the object.</h3>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an Index object</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> pd.Index(np.arange(<span class="dv">3</span>))</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(labels, <span class="bu">type</span>(labels))</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a Series using the index object</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>obj2 <span class="op">=</span> pd.Series([<span class="fl">1.5</span>, <span class="op">-</span><span class="fl">2.5</span>, <span class="dv">0</span>], index<span class="op">=</span>labels)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(obj2, <span class="bu">type</span>(obj2))</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Test equality of the index object</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(obj2.index <span class="kw">is</span> labels)</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">id</span>(obj2.index))</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">id</span>(labels))  <span class="co"># refering to the the same object</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Int64Index([0, 1, 2], dtype='int64') &lt;class 'pandas.core.indexes.numeric.Int64Index'&gt;
0    1.5
1   -2.5
2    0.0
dtype: float64 &lt;class 'pandas.core.series.Series'&gt;
True
1582613487184
1582613487184</code></pre>
</div>
</div>
</section>
<section id="q-create-a-dataframe-and-use-its-index-and-columns-to-test-set-operation-for-element-existence." class="level3">
<h3 class="anchored" data-anchor-id="q-create-a-dataframe-and-use-its-index-and-columns-to-test-set-operation-for-element-existence.">Q: Create a DataFrame and use its index and columns to test Set operation for element existence.</h3>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data source in a idctionary</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>populations <span class="op">=</span> {</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ohio"</span>: {<span class="dv">2000</span>: <span class="fl">1.5</span>, <span class="dv">2001</span>: <span class="fl">1.7</span>, <span class="dv">2002</span>: <span class="fl">3.6</span>},</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Nevada"</span>: {<span class="dv">2001</span>: <span class="fl">2.4</span>, <span class="dv">2002</span>: <span class="fl">2.9</span>}</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>frame3 <span class="op">=</span> pd.DataFrame(populations)</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(frame3)</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Index: Outer keys become column labels, Inner keys become row labels."</span>)</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Indexes for columns and rows</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(frame3.columns, <span class="bu">type</span>(frame3.columns))</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(frame3.index, <span class="bu">type</span>(frame3.index))</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Check with set operator</span></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Ohio is in index for columns: "</span>, <span class="st">"Ohio"</span> <span class="kw">in</span> frame3.columns)</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"2003 is in index for rows: "</span>, <span class="st">"2003"</span> <span class="kw">in</span> frame3.index)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Ohio  Nevada
2000   1.5     NaN
2001   1.7     2.4
2002   3.6     2.9
Index: Outer keys become column labels, Inner keys become row labels.
--------------------------------------------------
Index(['Ohio', 'Nevada'], dtype='object') &lt;class 'pandas.core.indexes.base.Index'&gt;
Int64Index([2000, 2001, 2002], dtype='int64') &lt;class 'pandas.core.indexes.numeric.Int64Index'&gt;
--------------------------------------------------
Ohio is in index for columns:  True
2003 is in index for rows:  False</code></pre>
</div>
</div>
</section>
<section id="q-concatenate-with-additional-index-objects-producing-a-new-index" class="level3">
<h3 class="anchored" data-anchor-id="q-concatenate-with-additional-index-objects-producing-a-new-index">Q: Concatenate with additional Index objects, producing a new index</h3>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an initial index</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>index1 <span class="op">=</span> pd.Index([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new index to append</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>index2 <span class="op">=</span> pd.Index([<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>])</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the append() method to concatenate index2 to index1import pandas as pd</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create two Index objects</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>index1 <span class="op">=</span> pd.Index([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>])</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>index2 <span class="op">=</span> pd.Index([<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>])</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the difference() method to find the set difference</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> index1.difference(index2)</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the elements in index1 that are not in index2</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>new_index <span class="op">=</span> index1.append(index2)</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the new concatenated index</span></span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(new_index)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Int64Index([1, 2], dtype='int64')
Int64Index([1, 2, 3, 4, 5, 3, 4, 5, 6, 7], dtype='int64')</code></pre>
</div>
</div>
</section>
<section id="q-compute-set-difference-intersection-and-union-as-an-index-between-two-index-objects" class="level3">
<h3 class="anchored" data-anchor-id="q-compute-set-difference-intersection-and-union-as-an-index-between-two-index-objects">Q: Compute set difference, intersection and union as an index between two index objects</h3>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create two Index objects</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>index1 <span class="op">=</span> pd.Index([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>])</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>index2 <span class="op">=</span> pd.Index([<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>])</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the difference() method to find the set difference</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> index1.difference(index2)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="co"># intersection</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> index1.intersection(index2)</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a><span class="co"># union</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> index1.union(index2)</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Int64Index([1, 2], dtype='int64')
Int64Index([3, 4, 5], dtype='int64')
Int64Index([1, 2, 3, 4, 5, 6, 7], dtype='int64')</code></pre>
</div>
</div>
</section>
<section id="q-compute-boolean-array-indicating-whether-each-value-is-contained-in-the-passed-collection" class="level3">
<h3 class="anchored" data-anchor-id="q-compute-boolean-array-indicating-whether-each-value-is-contained-in-the-passed-collection">Q: Compute Boolean array indicating whether each value is contained in the passed collection</h3>
<p>`</p>
</section>
</section>
</section>
<section id="create-an-index-object" class="level1">
<h1>Create an Index object</h1>
<p>index = pd.Index([1, 2, 3, 4, 5])</p>
</section>
<section id="create-a-collection-of-values-to-check-for-containment" class="level1">
<h1>Create a collection of values to check for containment</h1>
<p>collection = [3, 5, 7]</p>
</section>
<section id="use-the-isin-method-to-check-for-containment" class="level1">
<h1>Use the isin() method to check for containment</h1>
<p>is_in_collection = index.isin(collection)</p>
</section>
<section id="display-the-boolean-array-for-each-elements-containment" class="level1">
<h1>Display the Boolean array for each element’s containment</h1>
<p>print(is_in_collection)</p>
<pre><code>
### Q: Delete an element at a specific location in an Index and created a new updated Index.

::: {.cell execution_count=29}
``` {.python .cell-code}
# Create an INdex
index = pd.Index(['A', 'B', 'C', 'D'])
print(index)

# Delete an element at a specific position
new_index = index.delete(2)  # elemnt at position 2 (0-based)
print(new_index)</code></pre>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['A', 'B', 'C', 'D'], dtype='object')
Index(['A', 'B', 'D'], dtype='object')</code></pre>
</div>
<p>:::</p>
<section id="question-create-a-new-index-object-by-deleting-passed-lables-from-the-index." class="level3">
<h3 class="anchored" data-anchor-id="question-create-a-new-index-object-by-deleting-passed-lables-from-the-index.">Question: Create a new Index object by deleting passed lables from the index.</h3>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an Index</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>index <span class="op">=</span> pd.Index([<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>, <span class="st">'D'</span>, <span class="st">'E'</span>])</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"original Index obj: "</span>, index)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop specific labels from the Index</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>labels_to_drop <span class="op">=</span> [<span class="st">'B'</span>, <span class="st">'C'</span>]</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>new_index <span class="op">=</span> index.drop(labels_to_drop)</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"new Index obj: "</span>, new_index)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>original Index obj:  Index(['A', 'B', 'C', 'D', 'E'], dtype='object')
new Index obj:  Index(['A', 'D', 'E'], dtype='object')</code></pre>
</div>
</div>
</section>
<section id="question-create-a-new-index-object-by-inserting-new-labels-to-an-existing-index-object-after-the-element-matching-with-the-first-letter-of-the-new-label" class="level3">
<h3 class="anchored" data-anchor-id="question-create-a-new-index-object-by-inserting-new-labels-to-an-existing-index-object-after-the-element-matching-with-the-first-letter-of-the-new-label">Question: Create a new Index object by inserting new labels to an existing Index object, after the element matching with the first letter of the new label</h3>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a Index object</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>original_labels <span class="op">=</span> [<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>, <span class="st">'D'</span>, <span class="st">'E'</span>]</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>index <span class="op">=</span> pd.Index(original_labels)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Original index: "</span>, index)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="co"># additional labels to be inserted</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>additional_labels <span class="op">=</span> [<span class="st">'C-3'</span>, <span class="st">'C-5'</span>, <span class="st">'C-1'</span>, <span class="st">'C-2'</span>, <span class="st">'C-4'</span>]</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Labels to insert: "</span>, additional_labels)</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a><span class="co"># insert the labels</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>new_index <span class="op">=</span> index</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>additional_labels.sort(reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a><span class="co"># print("reverse-sorted additional labels: ", additional_labels)</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> label <span class="kw">in</span> additional_labels:</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>    first_letter <span class="op">=</span> label[:<span class="dv">1</span>]</span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (first_letter <span class="kw">in</span> original_labels):</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># find the index of the first letter</span></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>        idx <span class="op">=</span> original_labels.index(first_letter)</span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># print(first_letter, label, idx)</span></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>        new_index <span class="op">=</span> new_index.insert(idx<span class="op">+</span><span class="dv">1</span>, label)</span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"New index: "</span>, new_index)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Original index:  Index(['A', 'B', 'C', 'D', 'E'], dtype='object')
Labels to insert:  ['C-3', 'C-5', 'C-1', 'C-2', 'C-4']
New index:  Index(['A', 'B', 'C', 'C-1', 'C-2', 'C-3', 'C-4', 'C-5', 'D', 'E'], dtype='object')</code></pre>
</div>
</div>
</section>
<section id="question-you-have-a-pandas-index-object-and-you-want-to-check-if-it-is-monotonically-decreasing.-write-a-python-function-that-takes-an-index-object-as-input-and-returns-true-if-the-index-is-monotonically-decreasing-and-false-otherwise." class="level3">
<h3 class="anchored" data-anchor-id="question-you-have-a-pandas-index-object-and-you-want-to-check-if-it-is-monotonically-decreasing.-write-a-python-function-that-takes-an-index-object-as-input-and-returns-true-if-the-index-is-monotonically-decreasing-and-false-otherwise.">Question: You have a Pandas Index object, and you want to check if it is monotonically decreasing. Write a Python function that takes an Index object as input and returns <strong><code>True</code></strong> if the index is monotonically decreasing, and <strong><code>False</code></strong> otherwise.</h3>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to check if an Index is monotonically  decreasing</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_monotonic_decreasing(index):</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> index.is_monotonic_decreasing</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="co"># indexes to test</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>index1 <span class="op">=</span> pd.Index([<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>])</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>index2 <span class="op">=</span> pd.Index([<span class="st">'E'</span>, <span class="st">'D'</span>, <span class="st">'C'</span>, <span class="st">'B'</span>, <span class="st">'A'</span>])</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>index3 <span class="op">=</span> pd.Index([<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="st">'D'</span>, <span class="st">'C'</span>, <span class="st">'B'</span>])</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>list_of_index <span class="op">=</span> [index1, index2, index3]</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index <span class="kw">in</span> list_of_index:</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(index, is_monotonic_decreasing(index))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Int64Index([5, 4, 3, 2, 1], dtype='int64') True
Index(['E', 'D', 'C', 'B', 'A'], dtype='object') True
Index([4, 3, 2, 'D', 'C', 'B'], dtype='object') False</code></pre>
</div>
</div>
</section>
<section id="question-you-have-a-pandas-index-object-and-you-want-to-check-if-it-contains-unique-elements.-write-a-python-function-that-takes-an-index-object-as-input-and-returns-true-if-all-the-elements-are-unique-and-false-otherwise." class="level3">
<h3 class="anchored" data-anchor-id="question-you-have-a-pandas-index-object-and-you-want-to-check-if-it-contains-unique-elements.-write-a-python-function-that-takes-an-index-object-as-input-and-returns-true-if-all-the-elements-are-unique-and-false-otherwise.">Question: You have a Pandas Index object, and you want to check if it contains unique elements. Write a Python function that takes an Index object as input and returns <code>True</code> if all the elements are unique, and <code>False</code> otherwise.</h3>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create indexes for testing</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>index1 <span class="op">=</span> pd.Index([<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>, <span class="st">'D'</span>, <span class="st">'E'</span>])</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>index2 <span class="op">=</span> pd.Index([<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>, <span class="st">'A'</span>, <span class="st">'D'</span>])</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to check if an Index contatins unique elements</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_unique(index):</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> index.is_unique</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Test the indexes</span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(index1, is_unique(index1))</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(index2, is_unique(index2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['A', 'B', 'C', 'D', 'E'], dtype='object') True
Index(['A', 'B', 'C', 'A', 'D'], dtype='object') False</code></pre>
</div>
</div>
</section>
<section id="you-have-a-pandas-index-object-and-you-want-to-retrieve-the-unique-elements-from-it.-write-a-python-function-that-takes-an-index-object-as-input-and-returns-a-list-of-unique-elements-from-the-index." class="level3">
<h3 class="anchored" data-anchor-id="you-have-a-pandas-index-object-and-you-want-to-retrieve-the-unique-elements-from-it.-write-a-python-function-that-takes-an-index-object-as-input-and-returns-a-list-of-unique-elements-from-the-index.">You have a Pandas Index object, and you want to retrieve the unique elements from it. Write a Python function that takes an Index object as input and returns a list of unique elements from the index.</h3>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>index <span class="op">=</span> pd.Index([<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>, <span class="st">'A'</span>, <span class="st">'D'</span>, <span class="st">'B'</span>])</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_unique_elements(index):</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> index.unique()</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>unique_elements <span class="op">=</span> get_unique_elements(index)</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Unique elements: "</span>, unique_elements)  <span class="co"># Index object</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(unique_elements.tolist())  <span class="co"># List object</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Unique elements:  Index(['A', 'B', 'C', 'D'], dtype='object')
['A', 'B', 'C', 'D']</code></pre>
</div>
</div>
</section>
<section id="the-mechanics-of-interacting-with-data-in-series-and-dataframe" class="level2">
<h2 class="anchored" data-anchor-id="the-mechanics-of-interacting-with-data-in-series-and-dataframe">The mechanics of interacting with data in Series and DataFrame</h2>
<section id="question-youre-working-with-a-dataset-of-daily-stock-prices-for-a-portfolio-of-companies.-the-dataset-has-missing-values-for-certain-days-and-you-want-to-reindex-it-to-ensure-you-have-a-complete-set-of-daily-data-for-a-specified-date-range.-you-need-to-create-a-python-function-that-takes-several-arguments-to-demonstrate-the-use-of-the-reindex-method-and-its-optional-parameters.-your-task-is-to-implement-the-reindex_stock_data-function-which-demonstrates-the-use-of-these-parameters.-the-function-should-reindex-the-stock-price-data-to-the-specified-date-range-filling-missing-data-with-the-provided-fill_value-and-considering-the-other-optional-parameters." class="level3">
<h3 class="anchored" data-anchor-id="question-youre-working-with-a-dataset-of-daily-stock-prices-for-a-portfolio-of-companies.-the-dataset-has-missing-values-for-certain-days-and-you-want-to-reindex-it-to-ensure-you-have-a-complete-set-of-daily-data-for-a-specified-date-range.-you-need-to-create-a-python-function-that-takes-several-arguments-to-demonstrate-the-use-of-the-reindex-method-and-its-optional-parameters.-your-task-is-to-implement-the-reindex_stock_data-function-which-demonstrates-the-use-of-these-parameters.-the-function-should-reindex-the-stock-price-data-to-the-specified-date-range-filling-missing-data-with-the-provided-fill_value-and-considering-the-other-optional-parameters.">Question: You’re working with a dataset of daily stock prices for a portfolio of companies. The dataset has missing values for certain days, and you want to reindex it to ensure you have a complete set of daily data for a specified date range. You need to create a Python function that takes several arguments to demonstrate the use of the reindex() method and its optional parameters. Your task is to implement the reindex_stock_data() function, which demonstrates the use of these parameters. The function should reindex the stock price data to the specified date range, filling missing data with the provided fill_value and considering the other optional parameters.</h3>
<ul>
<li><code>data</code>: A DataFrame containing stock price data with a date index.</li>
<li><code>start_date</code>: The start date of the desired date range.</li>
<li><code>end_date</code>: The end date of the desired date range.</li>
<li><code>fill_value</code>: The value to fill missing data points.</li>
<li><code>method</code>: A method to use for filling missing values (e.g., ‘ffill’, ‘bfill’).</li>
<li><code>limit</code>: The maximum number of consecutive NaN values to fill.</li>
<li><code>tolerance</code>: The maximum allowed difference in the index value when reindexing.</li>
<li><code>level</code>: The level in case of MultiIndex.</li>
<li><code>copy</code>: Whether to create a copy of the original data or reindex in-place.</li>
</ul>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to reindex data as the parameters instruct</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reindex_stock_data(</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>    data,</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>    start_date,</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>    end_date,</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>    fill_value,</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>    method<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>    limit<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>    tolerance<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>    level<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>    copy<span class="op">=</span><span class="va">False</span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print("fill_value passed in: " + str(fill_value))</span></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fill NaN values with the specified fill_value</span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>    data_filled <span class="op">=</span> data.fillna(fill_value)</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print("data_filled:\n", data_filled)</span></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate fixed-frequency Datetime index - index of dates and times</span></span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>    date_range <span class="op">=</span> pd.date_range(start<span class="op">=</span>start_date, end<span class="op">=</span>end_date, freq<span class="op">=</span><span class="st">'D'</span>)</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Reindex the filled data</span></span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> data_filled.reindex(date_range, method<span class="op">=</span>method, tolerance<span class="op">=</span>tolerance,</span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>                                 limit<span class="op">=</span>limit, fill_value<span class="op">=</span>fill_value, level<span class="op">=</span>level, copy<span class="op">=</span>copy)</span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an incomplete initial data for testing</span></span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.DataFrame({</span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">'AAPL'</span>: [<span class="dv">150</span>, <span class="dv">151</span>, np.nan, <span class="dv">153</span>, np.nan],</span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">'GOOGL'</span>: [<span class="dv">2000</span>, np.nan, <span class="dv">2020</span>, <span class="dv">2030</span>, <span class="dv">2040</span>],</span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">'MSFT'</span>: [<span class="dv">300</span>, np.nan, <span class="dv">302</span>, np.nan, <span class="dv">304</span>],</span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">'AMZN'</span>: [<span class="dv">3500</span>, <span class="dv">3510</span>, np.nan, np.nan, <span class="dv">3540</span>],</span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">'TSLA'</span>: [np.nan, <span class="dv">701</span>, <span class="dv">702</span>, <span class="dv">703</span>, np.nan]</span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a>}, index<span class="op">=</span>pd.date_range(start<span class="op">=</span><span class="st">'2022-01-01'</span>, periods<span class="op">=</span><span class="dv">5</span>, freq<span class="op">=</span><span class="st">'D'</span>))</span>
<span id="cb68-34"><a href="#cb68-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Original data:</span><span class="ch">\n</span><span class="st">"</span>, data)</span>
<span id="cb68-35"><a href="#cb68-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-36"><a href="#cb68-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Set parameters and values for the function - reindexing</span></span>
<span id="cb68-37"><a href="#cb68-37" aria-hidden="true" tabindex="-1"></a>start_date <span class="op">=</span> <span class="st">'2022-01-01'</span></span>
<span id="cb68-38"><a href="#cb68-38" aria-hidden="true" tabindex="-1"></a>end_date <span class="op">=</span> <span class="st">'2022-01-05'</span></span>
<span id="cb68-39"><a href="#cb68-39" aria-hidden="true" tabindex="-1"></a>fill_value <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb68-40"><a href="#cb68-40" aria-hidden="true" tabindex="-1"></a>method <span class="op">=</span> <span class="st">'bfill'</span>  <span class="co"># Backward fill</span></span>
<span id="cb68-41"><a href="#cb68-41" aria-hidden="true" tabindex="-1"></a>limit <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb68-42"><a href="#cb68-42" aria-hidden="true" tabindex="-1"></a>tolerance <span class="op">=</span> <span class="st">'1D'</span>  <span class="co"># Tolerance of 1 day</span></span>
<span id="cb68-43"><a href="#cb68-43" aria-hidden="true" tabindex="-1"></a>level <span class="op">=</span> <span class="va">None</span></span>
<span id="cb68-44"><a href="#cb68-44" aria-hidden="true" tabindex="-1"></a>copy <span class="op">=</span> <span class="va">True</span></span>
<span id="cb68-45"><a href="#cb68-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-46"><a href="#cb68-46" aria-hidden="true" tabindex="-1"></a><span class="co"># print("fill_value is: ", str(fill_value))</span></span>
<span id="cb68-47"><a href="#cb68-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Call the function and reindex the data</span></span>
<span id="cb68-48"><a href="#cb68-48" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> reindex_stock_data(</span>
<span id="cb68-49"><a href="#cb68-49" aria-hidden="true" tabindex="-1"></a>    data, start_date, end_date, fill_value, method, limit, tolerance, level, copy)</span>
<span id="cb68-50"><a href="#cb68-50" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Result re-indexed data:</span><span class="ch">\n</span><span class="st">"</span>, result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Original data:
              AAPL   GOOGL   MSFT    AMZN   TSLA
2022-01-01  150.0  2000.0  300.0  3500.0    NaN
2022-01-02  151.0     NaN    NaN  3510.0  701.0
2022-01-03    NaN  2020.0  302.0     NaN  702.0
2022-01-04  153.0  2030.0    NaN     NaN  703.0
2022-01-05    NaN  2040.0  304.0  3540.0    NaN
Result re-indexed data:
              AAPL   GOOGL   MSFT    AMZN   TSLA
2022-01-01  150.0  2000.0  300.0  3500.0    0.0
2022-01-02  151.0     0.0    0.0  3510.0  701.0
2022-01-03    0.0  2020.0  302.0     0.0  702.0
2022-01-04  153.0  2030.0    0.0     0.0  703.0
2022-01-05    0.0  2040.0  304.0  3540.0    0.0</code></pre>
</div>
</div>
</section>
</section>
<section id="question-create-a-dataframe-called-sales_data-that-contains-sales-data-for-various-products-in-different-stores.-use-the-sales_data-and-create-dataframes-below." class="level2">
<h2 class="anchored" data-anchor-id="question-create-a-dataframe-called-sales_data-that-contains-sales-data-for-various-products-in-different-stores.-use-the-sales_data-and-create-dataframes-below.">Question: Create a DataFrame called ‘sales_data’ that contains sales data for various products in different stores. Use the ‘sales_data’ and create DataFrames below.</h2>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dictionary of store sales data and a DataFrmae</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Store'</span>: [<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>, <span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>, <span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>],</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Products'</span>: [<span class="st">'X'</span>, <span class="st">'Y'</span>, <span class="st">'Z'</span>, <span class="st">'X'</span>, <span class="st">'Y'</span>, <span class="st">'Z'</span>, <span class="st">'X'</span>, <span class="st">'Y'</span>, <span class="st">'Z'</span>],</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Sales'</span>: [<span class="dv">1000</span>, <span class="dv">1500</span>, <span class="dv">1200</span>, <span class="dv">2000</span>, <span class="dv">1800</span>, <span class="dv">2200</span>, <span class="dv">1200</span>, <span class="dv">1400</span>, <span class="dv">1100</span>]</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>sales_data <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sales_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Store Products  Sales
0     A        X   1000
1     B        Y   1500
2     C        Z   1200
3     A        X   2000
4     B        Y   1800
5     C        Z   2200
6     A        X   1200
7     B        Y   1400
8     C        Z   1100</code></pre>
</div>
</div>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame called 'store_A_sales', </span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="co"># by selecting all the products sold in Store A</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>cond <span class="op">=</span> sales_data[<span class="st">'Store'</span>] <span class="op">==</span> <span class="st">'A'</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>store_A_sales <span class="op">=</span> sales_data[cond]</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(store_A_sales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Store Products  Sales
0     A        X   1000
3     A        X   2000
6     A        X   1200</code></pre>
</div>
</div>
<p>Create a DataFrame called ‘high_sales_products’ for rows where ‘Sales’ is greater than or equal to 1500. Use the DataFrame ‘sales_data’. Display only ‘Products’ and ‘Sales’ columns.</p>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame indexing with Boolean values meeting the sales condition</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>high_sales_products <span class="op">=</span> sales_data.loc[sales_data[<span class="st">'Sales'</span>] <span class="op">&gt;=</span> <span class="dv">1500</span>, [<span class="st">'Products'</span>, <span class="st">'Sales'</span>]]</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"High sales products from store 'A'</span><span class="ch">\n</span><span class="st">"</span>, high_sales_products)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>High sales products from store 'A'
   Products  Sales
1        Y   1500
3        X   2000
4        Y   1800
5        Z   2200</code></pre>
</div>
</div>
<section id="dropping-entries-from-an-axis" class="level3">
<h3 class="anchored" data-anchor-id="dropping-entries-from-an-axis">Dropping Entries from an Axis</h3>
<p>Create a Series for the questions.</p>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>obj <span class="op">=</span> pd.Series(np.arange(<span class="fl">5.</span>), index<span class="op">=</span><span class="bu">list</span>(<span class="st">"abcde"</span>))</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(obj)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>a    0.0
b    1.0
c    2.0
d    3.0
e    4.0
dtype: float64</code></pre>
</div>
</div>
<section id="question-drop-single-or-multiple-indexes---c-or-c-and-d-both-from-the-series." class="level6">
<h6 class="anchored" data-anchor-id="question-drop-single-or-multiple-indexes---c-or-c-and-d-both-from-the-series."><strong>Question:</strong> Drop single or multiple indexes - ‘c’ or ‘c’ and ‘d’ both from the Series.</h6>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>new_obj <span class="op">=</span> obj.drop(<span class="st">'c'</span>)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(new_obj)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>new_obj <span class="op">=</span> obj.drop([<span class="st">'c'</span>,<span class="st">'d'</span>])</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(new_obj)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>a    0.0
b    1.0
d    3.0
e    4.0
dtype: float64
a    0.0
b    1.0
e    4.0
dtype: float64</code></pre>
</div>
</div>
</section>
<section id="indexing-and-retrieving-from-dataframe-with-a-single-value-of-sequence" class="level6">
<h6 class="anchored" data-anchor-id="indexing-and-retrieving-from-dataframe-with-a-single-value-of-sequence">Indexing and retrieving from DataFrame with a single value of sequence</h6>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.DataFrame(np.arange(<span class="dv">16</span>).reshape((<span class="dv">4</span>, <span class="dv">4</span>)),</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>                    index<span class="op">=</span>[<span class="st">"Ohio"</span>, <span class="st">"Colorado"</span>, <span class="st">"Utah"</span>, <span class="st">"New York"</span>],</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>                    columns<span class="op">=</span>[<span class="st">"one"</span>, <span class="st">"two"</span>, <span class="st">"three"</span>, <span class="st">"four"</span>]</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data)</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop 'Colorado' and 'Ohio', with a sequence of labels from the row labels (axis=0)</span></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>data2 <span class="op">=</span> data.drop(index<span class="op">=</span>[<span class="st">'Colorado'</span>, <span class="st">'Ohio'</span>])</span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data2)</span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop the column 'two'</span></span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>data2 <span class="op">=</span> data.drop(columns <span class="op">=</span> <span class="st">'two'</span>)</span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data2)</span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop column(s) using axis parameter</span></span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a>data2 <span class="op">=</span> data.drop(<span class="st">"one"</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data2)</span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a>data2 <span class="op">=</span> data.drop([<span class="st">"two"</span>, <span class="st">"four"</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          one  two  three  four
Ohio        0    1      2     3
Colorado    4    5      6     7
Utah        8    9     10    11
New York   12   13     14    15
          one  two  three  four
Utah        8    9     10    11
New York   12   13     14    15
          one  three  four
Ohio        0      2     3
Colorado    4      6     7
Utah        8     10    11
New York   12     14    15
          two  three  four
Ohio        1      2     3
Colorado    5      6     7
Utah        9     10    11
New York   13     14    15
          one  three
Ohio        0      2
Colorado    4      6
Utah        8     10
New York   12     14</code></pre>
</div>
</div>
</section>
<section id="indexing-selection-and-filtering" class="level6">
<h6 class="anchored" data-anchor-id="indexing-selection-and-filtering">Indexing, Selection, and Filtering</h6>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a Seriese</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>obj <span class="op">=</span> pd.Series(np.arange(<span class="fl">4.</span>), index<span class="op">=</span>[<span class="st">"a"</span>,<span class="st">"b"</span>,<span class="st">"c"</span>,<span class="st">"d"</span>])</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(obj)</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Select using a label</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(obj[<span class="st">"b"</span>])</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Select using a integer index (like NumPy)</span></span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(obj[<span class="dv">1</span>])</span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Select using a slice of integers (like NumPy)</span></span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(obj[<span class="dv">2</span>:<span class="dv">4</span>])</span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Select using a sequence of labels</span></span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(obj[[<span class="st">"b"</span>, <span class="st">"a"</span> , <span class="st">"d"</span>]])</span>
<span id="cb82-19"><a href="#cb82-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-20"><a href="#cb82-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Select using a list of integers</span></span>
<span id="cb82-21"><a href="#cb82-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(obj[[<span class="dv">1</span>, <span class="dv">3</span>]])</span>
<span id="cb82-22"><a href="#cb82-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-23"><a href="#cb82-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Select using an array of Boolean values, condition</span></span>
<span id="cb82-24"><a href="#cb82-24" aria-hidden="true" tabindex="-1"></a>cond <span class="op">=</span> obj <span class="op">&lt;</span> <span class="dv">2</span></span>
<span id="cb82-25"><a href="#cb82-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(obj[cond]) <span class="co"># equivalent to obj[[obj &lt; 2]]</span></span>
<span id="cb82-26"><a href="#cb82-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-27"><a href="#cb82-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Serieses</span></span>
<span id="cb82-28"><a href="#cb82-28" aria-hidden="true" tabindex="-1"></a>obj1 <span class="op">=</span> pd.Series([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], index<span class="op">=</span>[<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb82-29"><a href="#cb82-29" aria-hidden="true" tabindex="-1"></a>obj2 <span class="op">=</span> pd.Series([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], index<span class="op">=</span>[<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>])</span>
<span id="cb82-30"><a href="#cb82-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"obj1</span><span class="ch">\n</span><span class="st">:"</span>, obj1)</span>
<span id="cb82-31"><a href="#cb82-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"obj2</span><span class="ch">\n</span><span class="st">:"</span>, obj2)</span>
<span id="cb82-32"><a href="#cb82-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-33"><a href="#cb82-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Prefer to use loc when selecting using labels</span></span>
<span id="cb82-34"><a href="#cb82-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(obj2.loc[[<span class="st">"b"</span>, <span class="st">"a"</span>, <span class="st">"c"</span>]])</span>
<span id="cb82-35"><a href="#cb82-35" aria-hidden="true" tabindex="-1"></a><span class="co">#print(obj2.loc[[0, 1, 2]]) # error, not all indexes have matching labels</span></span>
<span id="cb82-36"><a href="#cb82-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(obj1.loc[[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>]])</span>
<span id="cb82-37"><a href="#cb82-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-38"><a href="#cb82-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Use iloc for indexing with integers</span></span>
<span id="cb82-39"><a href="#cb82-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(obj1.iloc[[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>]])</span>
<span id="cb82-40"><a href="#cb82-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(obj2.iloc[[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>]]) <span class="co"># iloc always work with integer indexing</span></span>
<span id="cb82-41"><a href="#cb82-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-42"><a href="#cb82-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Slicing inclusive of endpoint</span></span>
<span id="cb82-43"><a href="#cb82-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(obj2.loc[<span class="st">"b"</span>:<span class="st">"c"</span>]) <span class="co"># "c" label included for selection</span></span>
<span id="cb82-44"><a href="#cb82-44" aria-hidden="true" tabindex="-1"></a>obj2.loc[<span class="st">"b"</span>:<span class="st">"c"</span>] <span class="op">=</span> <span class="dv">99</span> <span class="co"># modify values using label slicing</span></span>
<span id="cb82-45"><a href="#cb82-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(obj2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>a    0.0
b    1.0
c    2.0
d    3.0
dtype: float64
1.0
1.0
c    2.0
d    3.0
dtype: float64
b    1.0
a    0.0
d    3.0
dtype: float64
b    1.0
d    3.0
dtype: float64
a    0.0
b    1.0
dtype: float64
obj1
: 2    1
0    2
1    3
dtype: int64
obj2
: a    1
b    2
c    3
dtype: int64
b    2
a    1
c    3
dtype: int64
0    2
1    3
2    1
dtype: int64
2    1
0    2
1    3
dtype: int64
a    1
b    2
c    3
dtype: int64
b    2
c    3
dtype: int64
a     1
b    99
c    99
dtype: int64</code></pre>
</div>
</div>
</section>
<section id="indexing-into-a-dataframe-retriving-one-or-more-columns-with-single-value-or-sequence" class="level6">
<h6 class="anchored" data-anchor-id="indexing-into-a-dataframe-retriving-one-or-more-columns-with-single-value-or-sequence">Indexing into a DataFrame retriving one or more columns with single value or sequence</h6>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create some state index and columns with random integer value, 4x4</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.DataFrame(np.arange(<span class="dv">16</span>).reshape(<span class="dv">4</span>, <span class="dv">4</span>), </span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>                    index<span class="op">=</span>[<span class="st">"Ohio"</span>, <span class="st">"Colorado"</span>, <span class="st">"Utah"</span>, <span class="st">"New York"</span>],</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>                    columns<span class="op">=</span>[<span class="st">"one"</span>, <span class="st">"two"</span>, <span class="st">"three"</span>, <span class="st">"four"</span>]</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data)</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data.index)</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data.columns)</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Select with a single or sequence</span></span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data[<span class="st">"one"</span>]) <span class="co"># single column "one"</span></span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data[[<span class="st">"three"</span>, <span class="st">"two"</span>]]) <span class="co"># multiple columns - three, </span></span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Select with slicing</span></span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data[:<span class="dv">2</span>])  <span class="co"># select row index at 0, 1</span></span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Select / assign using Boolean array</span></span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>cond <span class="op">=</span> data[<span class="st">"three"</span>] <span class="op">&gt;</span> <span class="dv">5</span></span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"cond:</span><span class="ch">\n</span><span class="st">"</span>, cond, <span class="bu">type</span>(cond)) <span class="co"># return a Series</span></span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data[cond])</span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a>cond <span class="op">=</span> data <span class="op">&lt;</span> <span class="dv">5</span></span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"cond</span><span class="ch">\n</span><span class="st">"</span>, cond, <span class="bu">type</span>(cond)) <span class="co"># return a DF</span></span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data[cond])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          one  two  three  four
Ohio        0    1      2     3
Colorado    4    5      6     7
Utah        8    9     10    11
New York   12   13     14    15
Index(['Ohio', 'Colorado', 'Utah', 'New York'], dtype='object')
Index(['one', 'two', 'three', 'four'], dtype='object')
Ohio         0
Colorado     4
Utah         8
New York    12
Name: one, dtype: int32
          three  two
Ohio          2    1
Colorado      6    5
Utah         10    9
New York     14   13
          one  two  three  four
Ohio        0    1      2     3
Colorado    4    5      6     7
cond:
 Ohio        False
Colorado     True
Utah         True
New York     True
Name: three, dtype: bool &lt;class 'pandas.core.series.Series'&gt;
          one  two  three  four
Colorado    4    5      6     7
Utah        8    9     10    11
New York   12   13     14    15
cond
             one    two  three   four
Ohio       True   True   True   True
Colorado   True  False  False  False
Utah      False  False  False  False
New York  False  False  False  False &lt;class 'pandas.core.frame.DataFrame'&gt;
          one  two  three  four
Ohio      0.0  1.0    2.0   3.0
Colorado  4.0  NaN    NaN   NaN
Utah      NaN  NaN    NaN   NaN
New York  NaN  NaN    NaN   NaN</code></pre>
</div>
</div>
</section>
<section id="selection-on-dataframe-with-loc-and-iloc" class="level6">
<h6 class="anchored" data-anchor-id="selection-on-dataframe-with-loc-and-iloc">Selection on DataFrame with <code>loc</code> and <code>iloc</code></h6>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="co"># loc with labels</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data.loc[<span class="st">"Colorado"</span>]) <span class="co"># Series</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data.loc[[<span class="st">"Colorado"</span>, <span class="st">"New York"</span>]]) <span class="co"># DF</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>sel <span class="op">=</span> data.loc[<span class="st">"Colorado"</span>, [<span class="st">"two"</span>, <span class="st">"three"</span>]] <span class="co"># Series</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sel)</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(sel))</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a><span class="co"># iloc with integers</span></span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data.iloc[<span class="dv">2</span>]) <span class="co"># Series</span></span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data.iloc[[<span class="dv">2</span>, <span class="dv">1</span>]]) <span class="co"># two rows, DF</span></span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data.iloc[<span class="dv">2</span>, [<span class="dv">2</span>, <span class="dv">1</span>]]) <span class="co"># row + columns, Series</span></span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data.iloc[[<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>]]) <span class="co"># rows + columns, DF</span></span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Slicing</span></span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data.loc[:<span class="st">"Utah"</span>, <span class="st">"two"</span>]) <span class="co"># slicing using row and colum labels at once</span></span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data.iloc[:, :<span class="dv">3</span>][data.three <span class="op">&gt;=</span> <span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          one  two  three  four
Ohio        0    1      2     3
Colorado    4    5      6     7
Utah        8    9     10    11
New York   12   13     14    15
one      4
two      5
three    6
four     7
Name: Colorado, dtype: int32
          one  two  three  four
Colorado    4    5      6     7
New York   12   13     14    15
two      5
three    6
Name: Colorado, dtype: int32
&lt;class 'pandas.core.series.Series'&gt;
one       8
two       9
three    10
four     11
Name: Utah, dtype: int32
          one  two  three  four
Utah        8    9     10    11
Colorado    4    5      6     7
three    10
two       9
Name: Utah, dtype: int32
          four  one  two
Colorado     7    4    5
Utah        11    8    9
Ohio        1
Colorado    5
Utah        9
Name: two, dtype: int32
          one  two  three
Ohio        0    1      2
Colorado    4    5      6
Utah        8    9     10
New York   12   13     14</code></pre>
</div>
</div>
</section>
<section id="arithmetic-and-data-alignment-with-series-and-dataframe" class="level6">
<h6 class="anchored" data-anchor-id="arithmetic-and-data-alignment-with-series-and-dataframe">Arithmetic and Data Alignment with Series and DataFrame</h6>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create two Serieses with different number of data and labels</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>s1 <span class="op">=</span> pd.Series([<span class="fl">7.3</span>, <span class="op">-</span><span class="fl">2.5</span>, <span class="fl">3.4</span>, <span class="fl">1.5</span>], index<span class="op">=</span>[<span class="st">"a"</span>, <span class="st">"c"</span>, <span class="st">"d"</span>, <span class="st">"e"</span>])</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>s2 <span class="op">=</span> pd.Series([<span class="op">-</span><span class="fl">2.1</span>, <span class="fl">3.6</span>, <span class="op">-</span><span class="fl">1.5</span>, <span class="dv">4</span>, <span class="fl">3.1</span>], index<span class="op">=</span>[<span class="st">"a"</span>, <span class="st">"c"</span>, <span class="st">"e"</span>, <span class="st">"f"</span>, <span class="st">"g"</span>])</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(s1)</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(s2)</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a><span class="co"># s1 + s2, result with the union of the index pairs and data alignment</span></span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(s1 <span class="op">+</span> s2)</span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create two DataFrames - 3x3 / 4x3</span></span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> pd.DataFrame(np.arange(<span class="fl">9.</span>).reshape((<span class="dv">3</span>, <span class="dv">3</span>)), columns<span class="op">=</span><span class="bu">list</span>(<span class="st">"bcd"</span>), index<span class="op">=</span>[<span class="st">"Ohio"</span>, <span class="st">"Texas"</span>, <span class="st">"Colorado"</span>])</span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> pd.DataFrame(np.arange(<span class="fl">12.</span>).reshape((<span class="dv">4</span>, <span class="dv">3</span>)), columns<span class="op">=</span><span class="bu">list</span>(<span class="st">"bde"</span>), index<span class="op">=</span>[<span class="st">"Utah"</span>, <span class="st">"Ohio"</span>, <span class="st">"Texas"</span>, <span class="st">"Oregon"</span>])</span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df1)</span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df2)</span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a><span class="co"># df1 + df2 , Union of index pairs and data alignment</span></span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df1<span class="op">+</span>df2)</span>
<span id="cb88-21"><a href="#cb88-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-22"><a href="#cb88-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Case of DataFrames with no rows or columns in common</span></span>
<span id="cb88-23"><a href="#cb88-23" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> pd.DataFrame({<span class="st">"A"</span>: [<span class="dv">1</span>, <span class="dv">2</span>]})</span>
<span id="cb88-24"><a href="#cb88-24" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> pd.DataFrame({<span class="st">"B"</span>: [<span class="dv">3</span>, <span class="dv">4</span>]})</span>
<span id="cb88-25"><a href="#cb88-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df1)</span>
<span id="cb88-26"><a href="#cb88-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df2)</span>
<span id="cb88-27"><a href="#cb88-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df1<span class="op">+</span>df2)</span>
<span id="cb88-28"><a href="#cb88-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-29"><a href="#cb88-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Practice to fill missing value(NaN, null) with sepcific value during arithmetic operations</span></span>
<span id="cb88-30"><a href="#cb88-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-31"><a href="#cb88-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Create DataFrames with different shapes, with data not in common and null</span></span>
<span id="cb88-32"><a href="#cb88-32" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> pd.DataFrame(np.arange(<span class="fl">12.</span>).reshape((<span class="dv">3</span>, <span class="dv">4</span>)), columns<span class="op">=</span><span class="bu">list</span>(<span class="st">"abcd"</span>))</span>
<span id="cb88-33"><a href="#cb88-33" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> pd.DataFrame(np.arange(<span class="fl">20.</span>).reshape((<span class="dv">4</span>, <span class="dv">5</span>)), columns<span class="op">=</span><span class="bu">list</span>(<span class="st">"abcde"</span>))</span>
<span id="cb88-34"><a href="#cb88-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-35"><a href="#cb88-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Set null for the value at 1, "b" in df2</span></span>
<span id="cb88-36"><a href="#cb88-36" aria-hidden="true" tabindex="-1"></a>df2.loc[<span class="dv">1</span>, <span class="st">"b"</span>] <span class="op">=</span> np.nan</span>
<span id="cb88-37"><a href="#cb88-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-38"><a href="#cb88-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"df1: "</span>, df1)</span>
<span id="cb88-39"><a href="#cb88-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"df2: "</span>, df2)</span>
<span id="cb88-40"><a href="#cb88-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-41"><a href="#cb88-41" aria-hidden="true" tabindex="-1"></a><span class="co"># addtion and missing values</span></span>
<span id="cb88-42"><a href="#cb88-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df1 <span class="op">+</span> df2)</span>
<span id="cb88-43"><a href="#cb88-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-44"><a href="#cb88-44" aria-hidden="true" tabindex="-1"></a><span class="co"># add() method and fill_value argument to substitute missing values during arithmetic operations.</span></span>
<span id="cb88-45"><a href="#cb88-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df1.add(df2, fill_value<span class="op">=</span><span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>a    7.3
c   -2.5
d    3.4
e    1.5
dtype: float64
a   -2.1
c    3.6
e   -1.5
f    4.0
g    3.1
dtype: float64
a    5.2
c    1.1
d    NaN
e    0.0
f    NaN
g    NaN
dtype: float64
            b    c    d
Ohio      0.0  1.0  2.0
Texas     3.0  4.0  5.0
Colorado  6.0  7.0  8.0
          b     d     e
Utah    0.0   1.0   2.0
Ohio    3.0   4.0   5.0
Texas   6.0   7.0   8.0
Oregon  9.0  10.0  11.0
            b   c     d   e
Colorado  NaN NaN   NaN NaN
Ohio      3.0 NaN   6.0 NaN
Oregon    NaN NaN   NaN NaN
Texas     9.0 NaN  12.0 NaN
Utah      NaN NaN   NaN NaN
   A
0  1
1  2
   B
0  3
1  4
    A   B
0 NaN NaN
1 NaN NaN
df1:       a    b     c     d
0  0.0  1.0   2.0   3.0
1  4.0  5.0   6.0   7.0
2  8.0  9.0  10.0  11.0
df2:        a     b     c     d     e
0   0.0   1.0   2.0   3.0   4.0
1   5.0   NaN   7.0   8.0   9.0
2  10.0  11.0  12.0  13.0  14.0
3  15.0  16.0  17.0  18.0  19.0
      a     b     c     d   e
0   0.0   2.0   4.0   6.0 NaN
1   9.0   NaN  13.0  15.0 NaN
2  18.0  20.0  22.0  24.0 NaN
3   NaN   NaN   NaN   NaN NaN
      a     b     c     d     e
0   0.0   2.0   4.0   6.0   4.0
1   9.0   5.0  13.0  15.0   9.0
2  18.0  20.0  22.0  24.0  14.0
3  15.0  16.0  17.0  18.0  19.0</code></pre>
</div>
</div>


</section>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Copyright 2023, Albert Joonyoung Park.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>



</body></html>