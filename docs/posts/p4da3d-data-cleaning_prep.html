<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2023-11-10">
<meta name="description" content="Learning notes - Python for Data Analysis, 3E - Wes McKinney">

<title>Albert Joonyoung Park - Data Cleaning and Preparation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Albert Joonyoung Park</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text">HOME</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../projects.html" rel="" target="">
 <span class="menu-text">PROJECTS</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../blog.html" rel="" target="">
 <span class="menu-text">BLOG</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">ABOUT</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
    <a href="https://github.com/albert-joonyoung-park" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
    <a href="" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-linkedin"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#data-cleaning-and-preparation" id="toc-data-cleaning-and-preparation" class="nav-link active" data-scroll-target="#data-cleaning-and-preparation">Data Cleaning and Preparation</a>
  <ul class="collapse">
  <li><a href="#handling-missing-data" id="toc-handling-missing-data" class="nav-link" data-scroll-target="#handling-missing-data">1. Handling Missing Data</a>
  <ul class="collapse">
  <li><a href="#filtering-out-missing-data" id="toc-filtering-out-missing-data" class="nav-link" data-scroll-target="#filtering-out-missing-data">1.1 Filtering Out Missing Data</a></li>
  <li><a href="#filling-in-missing-data" id="toc-filling-in-missing-data" class="nav-link" data-scroll-target="#filling-in-missing-data">1.2 Filling In Missing Data</a></li>
  </ul></li>
  <li><a href="#data-transformation" id="toc-data-transformation" class="nav-link" data-scroll-target="#data-transformation">2. Data Transformation</a>
  <ul class="collapse">
  <li><a href="#removing-duplicates" id="toc-removing-duplicates" class="nav-link" data-scroll-target="#removing-duplicates">2.1 Removing Duplicates</a></li>
  <li><a href="#transforming-using-a-function-or-mapping" id="toc-transforming-using-a-function-or-mapping" class="nav-link" data-scroll-target="#transforming-using-a-function-or-mapping">2.2 Transforming Using a Function or Mapping</a></li>
  <li><a href="#replacing-values" id="toc-replacing-values" class="nav-link" data-scroll-target="#replacing-values">2.3 Replacing Values</a></li>
  <li><a href="#renaming-axies-indexes" id="toc-renaming-axies-indexes" class="nav-link" data-scroll-target="#renaming-axies-indexes">2.4 Renaming Axies Indexes</a></li>
  <li><a href="#discretization-and-binning" id="toc-discretization-and-binning" class="nav-link" data-scroll-target="#discretization-and-binning">2.5 Discretization and Binning</a></li>
  <li><a href="#detecting-and-filtering-outliers" id="toc-detecting-and-filtering-outliers" class="nav-link" data-scroll-target="#detecting-and-filtering-outliers">2.6 Detecting and Filtering Outliers</a></li>
  <li><a href="#permutation-and-random-sampling" id="toc-permutation-and-random-sampling" class="nav-link" data-scroll-target="#permutation-and-random-sampling">2.7 Permutation and Random Sampling</a></li>
  <li><a href="#computing-indicatordummy-variables" id="toc-computing-indicatordummy-variables" class="nav-link" data-scroll-target="#computing-indicatordummy-variables">2.8 Computing Indicator/Dummy Variables</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Data Cleaning and Preparation</h1>
<p class="subtitle lead">Analysis techniques using pandas - Python for Data Analysis, 3E by Wes McKinney</p>
  <div class="quarto-categories">
    <div class="quarto-category">Python</div>
    <div class="quarto-category">pandas</div>
    <div class="quarto-category">data cleaning</div>
    <div class="quarto-category">data preparation</div>
  </div>
  </div>

<div>
  <div class="description">
    Learning notes - Python for Data Analysis, 3E - Wes McKinney
  </div>
</div>


<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 10, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<hr>
<section id="data-cleaning-and-preparation" class="level1">
<h1>Data Cleaning and Preparation</h1>
<section id="handling-missing-data" class="level2">
<h2 class="anchored" data-anchor-id="handling-missing-data">1. Handling Missing Data</h2>
<p><code>NaN</code> as sentinel value for missing data</p>
<p><code>isna</code> to generate a Series of Boolean for null</p>
<p><code>None</code> from Python built-in for missing data</p>
<p>When data cleaning, consider running analysis on missing data itself for data collection issues or potential biaes in the data caused by missing data</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># NaN in float64</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>float_data <span class="op">=</span> pd.Series([<span class="fl">1.2</span>, <span class="op">-</span><span class="fl">3.5</span>, np.nan, <span class="dv">0</span>])</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>float_data</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>float_data.isna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>0    False
1    False
2     True
3    False
dtype: bool</code></pre>
</div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># None, Python built-in null</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>string_data <span class="op">=</span> pd.Series([<span class="st">"aardvark"</span>, np.nan, <span class="va">None</span>, <span class="st">"avocado"</span>])</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>string_data</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>string_data.isna()</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>float_data <span class="op">=</span> pd.Series([<span class="dv">1</span>, <span class="dv">2</span>, <span class="va">None</span>], dtype<span class="op">=</span><span class="st">"float64"</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>float_data</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>float_data.isna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>0    False
1    False
2     True
dtype: bool</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p><em>“You have a dataset containing information about users and their scores in an online game. The dataset has missing values, and you need to clean it by addressing the missing values using pandas functions.”</em></p>
<ol type="1">
<li>Remove rows with missing values.</li>
<li>Fill missing values in the ‘score’ column with the mean score.</li>
<li>Identify rows with missing values in the ‘username’ column.</li>
<li>Identify rows without missing values in the ‘level’ column.</li>
</ol>
</blockquote>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Dataset</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">'username'</span>: [<span class="st">'user1'</span>, <span class="st">'user2'</span>, np.nan, <span class="st">'user4'</span>, <span class="st">'user5'</span>],</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">'score'</span>: [<span class="dv">100</span>, np.nan, <span class="dv">150</span>, <span class="dv">200</span>, np.nan],</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">'level'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, np.nan, <span class="dv">5</span>]</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Original data:"</span>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df, <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Remove rows with missing values.</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>df_cleaned1 <span class="op">=</span> df.dropna()</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Remove rows with missing values:"</span>)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_cleaned1, <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Fill missing values in the 'score' column with the mean score.</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>mean_score <span class="op">=</span> df[<span class="st">'score'</span>].mean()</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>df_cleaned2 <span class="op">=</span> df.fillna(value<span class="op">=</span>{<span class="st">'score'</span>: mean_score})</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Fill missing scores with mean score:"</span>)</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_cleaned2, <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Identify rows with missing values in the 'username' column.</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>is_missing_username <span class="op">=</span> df.isna()[<span class="st">"username"</span>]</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>df_rows_with_missing_username <span class="op">=</span> df[is_missing_username]</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Rows with missing username:"</span>)</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_rows_with_missing_username, <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Identify rows without missing values in the 'level' column.</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>is_without_missing_level <span class="op">=</span> df.notna()[<span class="st">"level"</span>]</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>df_rows_without_missing_level <span class="op">=</span> df[is_without_missing_level]</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Rows without missing level:"</span>)</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_rows_without_missing_level, <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Original data:
  username  score  level
0    user1  100.0    1.0
1    user2    NaN    2.0
2      NaN  150.0    3.0
3    user4  200.0    NaN
4    user5    NaN    5.0 

Remove rows with missing values:
  username  score  level
0    user1  100.0    1.0 

Fill missing scores with mean score:
  username  score  level
0    user1  100.0    1.0
1    user2  150.0    2.0
2      NaN  150.0    3.0
3    user4  200.0    NaN
4    user5  150.0    5.0 

Rows with missing username:
  username  score  level
2      NaN  150.0    3.0 

Rows without missing level:
  username  score  level
0    user1  100.0    1.0
1    user2    NaN    2.0
2      NaN  150.0    3.0
4    user5    NaN    5.0 
</code></pre>
</div>
</div>
<section id="filtering-out-missing-data" class="level3">
<h3 class="anchored" data-anchor-id="filtering-out-missing-data">1.1 Filtering Out Missing Data</h3>
<p>Filtering out missing data in Series</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.Series([<span class="dv">1</span>, np.nan, <span class="fl">3.5</span>, np.nan, <span class="dv">7</span>])</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Data: "</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data, <span class="bu">type</span>(data), <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Equvalency of dropna() and notna()</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Equivalency of dropna() and notna(): "</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data.dropna())</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data[data.notna()], <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: 
0    1.0
1    NaN
2    3.5
3    NaN
4    7.0
dtype: float64 &lt;class 'pandas.core.series.Series'&gt; 

Equivalency of dropna() and notna(): 
0    1.0
2    3.5
4    7.0
dtype: float64
0    1.0
2    3.5
4    7.0
dtype: float64 
</code></pre>
</div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.DataFrame([[<span class="fl">1.</span>, <span class="fl">6.5</span>, <span class="fl">3.</span>],</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>                    [<span class="fl">1.</span>, np.nan, np.nan],</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>                    [np.nan, np.nan, np.nan],</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>                    [np.nan, <span class="fl">6.5</span>, <span class="fl">3.</span>]])</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Original data: "</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data, <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop any ROWS with missing values - default</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Drop any ROWS with missing value: "</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data.dropna(), <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop only ROWS that are all NA</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Drop only ROWS that are all NA:"</span>)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data.dropna(how<span class="op">=</span><span class="st">"all"</span>), <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop columns</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Adding a new column with NA and dropping it: "</span>)</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>data[<span class="dv">4</span>] <span class="op">=</span> np.nan</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data)</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data.dropna(axis<span class="op">=</span><span class="st">"columns"</span>, how<span class="op">=</span><span class="st">"all"</span>), <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>) <span class="co"># drop only columns that are all NA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Original data: 
     0    1    2
0  1.0  6.5  3.0
1  1.0  NaN  NaN
2  NaN  NaN  NaN
3  NaN  6.5  3.0 

Drop any ROWS with missing value: 
     0    1    2
0  1.0  6.5  3.0 

Drop only ROWS that are all NA:
     0    1    2
0  1.0  6.5  3.0
1  1.0  NaN  NaN
3  NaN  6.5  3.0 

Adding a new column with NA and dropping it: 
     0    1    2   4
0  1.0  6.5  3.0 NaN
1  1.0  NaN  NaN NaN
2  NaN  NaN  NaN NaN
3  NaN  6.5  3.0 NaN
     0    1    2
0  1.0  6.5  3.0
1  1.0  NaN  NaN
2  NaN  NaN  NaN
3  NaN  6.5  3.0 
</code></pre>
</div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Preserve some rows with missing values, do not drop all of them</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample data and set some NA values</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(np.random.standard_normal((<span class="dv">7</span>, <span class="dv">3</span>)))</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>df.iloc[:<span class="dv">4</span>, <span class="dv">1</span>] <span class="op">=</span> np.nan</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>df.iloc[:<span class="dv">2</span>, <span class="dv">2</span>] <span class="op">=</span> np.nan</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Original data: "</span>)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df, <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop any rows with missing value</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Drop any rows with missing value:"</span>)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.dropna(), <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop any rows with missing values, but keep the row with certain number of NAs.</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Drop any rows with missing values, but preserve if NAs &lt; 2: "</span>)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.dropna(thresh<span class="op">=</span><span class="dv">2</span>), <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Original data: 
          0         1         2
0 -1.228094       NaN       NaN
1  0.982186       NaN       NaN
2 -0.026328       NaN -1.319205
3  0.721260       NaN -2.274546
4  0.664697 -0.627932 -1.301767
5  1.000291  1.446766  0.796659
6 -0.182660 -0.496278 -0.578758 

Drop any rows with missing value:
          0         1         2
4  0.664697 -0.627932 -1.301767
5  1.000291  1.446766  0.796659
6 -0.182660 -0.496278 -0.578758 

Drop any rows with missing values, but preserve if NAs &lt; 2: 
          0         1         2
2 -0.026328       NaN -1.319205
3  0.721260       NaN -2.274546
4  0.664697 -0.627932 -1.301767
5  1.000291  1.446766  0.796659
6 -0.182660 -0.496278 -0.578758 
</code></pre>
</div>
</div>
</section>
<section id="filling-in-missing-data" class="level3">
<h3 class="anchored" data-anchor-id="filling-in-missing-data">1.2 Filling In Missing Data</h3>
<p>Rather than dropping out missing data(potentially discarding other data along with it), you may want to fill in the “holes” in ways. - <code>fillna()</code></p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filling in missing data</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample data and set some NA values</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(np.random.standard_normal((<span class="dv">7</span>, <span class="dv">3</span>)))</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>df.iloc[:<span class="dv">4</span>, <span class="dv">1</span>] <span class="op">=</span> np.nan</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>df.iloc[:<span class="dv">2</span>, <span class="dv">2</span>] <span class="op">=</span> np.nan</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Original data: "</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df, <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill NA with some value</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Filling NA with number 0: "</span>)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.fillna(<span class="dv">0</span>), <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)  <span class="co"># filling NA with 0</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Filling NA with different values for columns"</span>)</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill NA with different fill value columns</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.fillna({<span class="dv">1</span>: <span class="fl">0.5</span>, <span class="dv">2</span>:<span class="dv">0</span>}), <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>) <span class="co"># 0.5 for col1, 0 for </span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill NA with more meaningful values for imputation</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample data frame and setting some NA values</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(np.random.standard_normal((<span class="dv">8</span>, <span class="dv">3</span>)))</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>df.iloc[<span class="dv">2</span>:<span class="dv">7</span>, <span class="dv">1</span>] <span class="op">=</span> np.nan</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>df.iloc[<span class="dv">4</span>:, <span class="dv">2</span>] <span class="op">=</span> np.nan</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Original data:"</span>)</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df, <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill NA using 'forward fill' method, do only for n consecutive NAs</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Fill NA using 'forward fill' method, do only for 3 consecutive NAs"</span>)</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.fillna(method<span class="op">=</span><span class="st">'ffill'</span>, limit<span class="op">=</span><span class="dv">3</span>)) <span class="co"># using the previous non-NA value</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.fillna(method<span class="op">=</span><span class="st">'bfill'</span>, limit<span class="op">=</span><span class="dv">3</span>)) <span class="co"># using the non-NA value behind</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Original data: 
          0         1         2
0 -1.411913       NaN       NaN
1  0.347497       NaN       NaN
2 -0.948835       NaN -2.177123
3  0.107214       NaN  1.495539
4  0.260233 -0.685786 -1.097632
5  0.316877 -2.474690 -0.323401
6  0.393796  0.866074  1.070525 

Filling NA with number 0: 
          0         1         2
0 -1.411913  0.000000  0.000000
1  0.347497  0.000000  0.000000
2 -0.948835  0.000000 -2.177123
3  0.107214  0.000000  1.495539
4  0.260233 -0.685786 -1.097632
5  0.316877 -2.474690 -0.323401
6  0.393796  0.866074  1.070525 

Filling NA with different values for columns
          0         1         2
0 -1.411913  0.500000  0.000000
1  0.347497  0.500000  0.000000
2 -0.948835  0.500000 -2.177123
3  0.107214  0.500000  1.495539
4  0.260233 -0.685786 -1.097632
5  0.316877 -2.474690 -0.323401
6  0.393796  0.866074  1.070525 

Original data:
          0         1         2
0 -0.757152  0.023778  1.168869
1  0.575411 -0.138309  0.970031
2  0.663887       NaN  0.425958
3  2.201875       NaN -0.046227
4  0.205636       NaN       NaN
5  0.441329       NaN       NaN
6 -1.794051       NaN       NaN
7 -0.078953  0.342802       NaN 

Fill NA using 'forward fill' method, do only for 3 consecutive NAs
          0         1         2
0 -0.757152  0.023778  1.168869
1  0.575411 -0.138309  0.970031
2  0.663887 -0.138309  0.425958
3  2.201875 -0.138309 -0.046227
4  0.205636 -0.138309 -0.046227
5  0.441329       NaN -0.046227
6 -1.794051       NaN -0.046227
7 -0.078953  0.342802       NaN
          0         1         2
0 -0.757152  0.023778  1.168869
1  0.575411 -0.138309  0.970031
2  0.663887       NaN  0.425958
3  2.201875       NaN -0.046227
4  0.205636  0.342802       NaN
5  0.441329  0.342802       NaN
6 -1.794051  0.342802       NaN
7 -0.078953  0.342802       NaN</code></pre>
</div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data imputation using fillna()</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample data</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.Series([<span class="fl">1.</span>, np.nan, <span class="fl">3.5</span>, np.nan, <span class="dv">7</span>])</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Original data: "</span>)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data, <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Fill NAs with mean / median value of the data set</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Fill NAs with mean value: "</span>)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data.fillna(data.mean()), <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Fill Nas with median value: "</span>)</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data.fillna(data.median()), <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Original data: 
0    1.0
1    NaN
2    3.5
3    NaN
4    7.0
dtype: float64 

Fill NAs with mean value: 
0    1.000000
1    3.833333
2    3.500000
3    3.833333
4    7.000000
dtype: float64 

Fill Nas with median value: 
0    1.0
1    3.5
2    3.5
3    3.5
4    7.0
dtype: float64 
</code></pre>
</div>
</div>
<p><code>fillna</code> function arguments</p>
<table class="table">
<colgroup>
<col style="width: 22%">
<col style="width: 77%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Argument</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>value</code></td>
<td style="text-align: left;">Scalar value or dictionary-like object to use to fill missing values</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>method</code></td>
<td style="text-align: left;">Interpolation method: one of <code>"bfill"</code> (backward fill) or <code>"ffill"</code> (forward fill); default is <code>None</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>axis</code></td>
<td style="text-align: left;">Axis to fill on (<code>"index"</code> or <code>"columns"</code>); default is <code>axis="index"</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>limit</code></td>
<td style="text-align: left;">For forward and backward filling, maximum number of consecutive periods to fill</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="data-transformation" class="level2">
<h2 class="anchored" data-anchor-id="data-transformation">2. Data Transformation</h2>
<p>Filtering, cleaning and other transformations</p>
<section id="removing-duplicates" class="level3">
<h3 class="anchored" data-anchor-id="removing-duplicates">2.1 Removing Duplicates</h3>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample data frame</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.DataFrame({<span class="st">"k1"</span>: [<span class="st">"one"</span>, <span class="st">"two"</span>] <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> [<span class="st">"two"</span>], </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"k2"</span>: [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>]})</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Original data:"</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data, <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Boolean Series for duplicate check</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Boolean flagas for duplicate rows:"</span>)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data.duplicated())</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Duplicated rows(s):"</span>)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data[data.duplicated()])</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop duplicated rows</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Dropping duplicated rows:"</span>)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data.drop_duplicates(), <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop duplicates only on specific column(s).</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"v1"</span>] <span class="op">=</span> <span class="bu">range</span>(<span class="dv">7</span>)  <span class="co"># add a new column</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data)</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Drop duplicates only on specific column(s)."</span>)</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data.drop_duplicates(subset<span class="op">=</span>[<span class="st">"k1"</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Original data:
    k1  k2
0  one   1
1  two   1
2  one   2
3  two   3
4  one   3
5  two   4
6  two   4 

Boolean flagas for duplicate rows:
0    False
1    False
2    False
3    False
4    False
5    False
6     True
dtype: bool
Duplicated rows(s):
    k1  k2
6  two   4
Dropping duplicated rows:
    k1  k2
0  one   1
1  two   1
2  one   2
3  two   3
4  one   3
5  two   4 

    k1  k2  v1
0  one   1   0
1  two   1   1
2  one   2   2
3  two   3   3
4  one   3   4
5  two   4   5
6  two   4   6
Drop duplicates only on specific column(s).
    k1  k2  v1
0  one   1   0
1  two   1   1</code></pre>
</div>
</div>
<p><code>duplicated</code>, <code>drop_duplicated</code> keeps the first observed value combo. <code>keep="last"</code> returns the last one instead.</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample data frame</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.DataFrame({<span class="st">"k1"</span>: [<span class="st">"one"</span>, <span class="st">"two"</span>] <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> [<span class="st">"two"</span>], </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"k2"</span>: [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>],</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"v1"</span>: <span class="bu">range</span>(<span class="dv">7</span>)})</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Preserve the last observed value of duplicates."</span>)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data.drop_duplicates([<span class="st">"k1"</span>, <span class="st">"k2"</span>], keep<span class="op">=</span><span class="st">"last"</span>)) <span class="co"># dropping row#5, preserving row#6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Preserve the last observed value of duplicates.
    k1  k2  v1
0  one   1   0
1  two   1   1
2  one   2   2
3  two   3   3
4  one   3   4
5  two   4   5
6  two   4   6
    k1  k2  v1
0  one   1   0
1  two   1   1
2  one   2   2
3  two   3   3
4  one   3   4
6  two   4   6</code></pre>
</div>
</div>
</section>
<section id="transforming-using-a-function-or-mapping" class="level3">
<h3 class="anchored" data-anchor-id="transforming-using-a-function-or-mapping">2.2 Transforming Using a Function or Mapping</h3>
<p>The <code>map</code> method on a Series accepts a function or dictionary-like object containing a mapping to do the transformation of values. Convenient way to element-wise transformations and other data cleaning-related operations.</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample dataset</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.DataFrame({</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"food"</span>: [<span class="st">"bacon"</span>, <span class="st">"pulled pork"</span>, <span class="st">"bacon"</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>           <span class="st">"pastrami"</span>, <span class="st">"corned beef"</span>, <span class="st">"bacon"</span>,</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>           <span class="st">"pastrami"</span>, <span class="st">"honey ham"</span>, <span class="st">"nova lox"</span>],</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ounces"</span>: [<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">12</span>, <span class="dv">6</span>, <span class="fl">7.5</span>, <span class="dv">8</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">6</span>]</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>data</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Dictionary to define key-value with meat and animal</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>meat_to_animal <span class="op">=</span> {</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"bacon"</span>: <span class="st">"pig"</span>,</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"pulled pork"</span>: <span class="st">"pig"</span>,</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"pastrami"</span>: <span class="st">"cow"</span>,</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">"corned beef"</span>: <span class="st">"cow"</span>,</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"honey ham"</span>: <span class="st">"pig"</span>,</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"nova lox"</span>: <span class="st">"salmon"</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a animal category column using map method and dictionary-like object</span></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"animal"</span>] <span class="op">=</span> data[<span class="st">"food"</span>].<span class="bu">map</span>(meat_to_animal)</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>data</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a animal category column using map method with a function objecdt</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_animal(x):</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> meat_to_animal[x]</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>data[<span class="st">"animal_cat"</span>] <span class="op">=</span> data[<span class="st">"food"</span>].<span class="bu">map</span>(get_animal)</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">food</th>
<th data-quarto-table-cell-role="th">ounces</th>
<th data-quarto-table-cell-role="th">animal</th>
<th data-quarto-table-cell-role="th">animal_cat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>bacon</td>
<td>4.0</td>
<td>pig</td>
<td>pig</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>pulled pork</td>
<td>3.0</td>
<td>pig</td>
<td>pig</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>bacon</td>
<td>12.0</td>
<td>pig</td>
<td>pig</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>pastrami</td>
<td>6.0</td>
<td>cow</td>
<td>cow</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>corned beef</td>
<td>7.5</td>
<td>cow</td>
<td>cow</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>bacon</td>
<td>8.0</td>
<td>pig</td>
<td>pig</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>pastrami</td>
<td>3.0</td>
<td>cow</td>
<td>cow</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>honey ham</td>
<td>5.0</td>
<td>pig</td>
<td>pig</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>nova lox</td>
<td>6.0</td>
<td>salmon</td>
<td>salmon</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="replacing-values" class="level3">
<h3 class="anchored" data-anchor-id="replacing-values">2.3 Replacing Values</h3>
<p><code>fillna</code> method is a special case of more general value replacement. <code>map</code> can be used to modify a subset of values in an object. <code>replace</code> is simpler and more flexible</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace specific value(s) with replacment(s)</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.Series([<span class="fl">1.</span>, <span class="op">-</span><span class="fl">999.</span>, <span class="fl">2.</span>, <span class="op">-</span><span class="fl">999.</span>, <span class="op">-</span><span class="fl">1000.</span>, <span class="fl">3.</span>, <span class="st">"Brown Fox"</span>])</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>data</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>data.replace({<span class="op">-</span><span class="dv">999</span>: np.nan, <span class="op">-</span><span class="dv">1000</span>:<span class="dv">0</span>, <span class="st">"Brown Fox"</span>: <span class="st">"Red Fox"</span>})  <span class="co"># multiple replacements using dictionary</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>0        1.0
1        NaN
2        2.0
3        NaN
4          0
5        3.0
6    Red Fox
dtype: object</code></pre>
</div>
</div>
</section>
<section id="renaming-axies-indexes" class="level3">
<h3 class="anchored" data-anchor-id="renaming-axies-indexes">2.4 Renaming Axies Indexes</h3>
<p>Using <code>map</code> method in axis indexes to modify axis labels <em>in place</em>, like <code>map</code> method in Series object. <code>rename</code> method of data frame creates new object with transformation</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample data</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.DataFrame(np.arange(<span class="dv">12</span>).reshape((<span class="dv">3</span>, <span class="dv">4</span>)),</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>                    index<span class="op">=</span>[<span class="st">"ohio"</span>, <span class="st">"colorado"</span>, <span class="st">"new york"</span>],</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>                    columns<span class="op">=</span>[<span class="st">"one"</span>, <span class="st">"two"</span>, <span class="st">"three"</span>, <span class="st">"four"</span>])</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Original some states data frame: </span><span class="ch">\n</span><span class="st">"</span>, data)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Transforming axis index labels in place</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> transform(x):</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> x[:<span class="dv">4</span>].upper()</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Transforming index labels in place:  </span><span class="ch">\n</span><span class="st">"</span>, data)</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>data.index <span class="op">=</span> data.index.<span class="bu">map</span>(transform)  <span class="co"># transformation of index labels</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Transforming axis index labels in a new data frame, passing functions / dictionary</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Transforming axis index labels in a new data frame, passing functions, dictionary.."</span>)</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>data.rename(index<span class="op">=</span><span class="bu">str</span>.title, columns<span class="op">=</span><span class="bu">str</span>.upper)  <span class="co"># passing string methods to titlecase / upper case the index and columns</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>data.rename(index<span class="op">=</span>{<span class="st">"OHIO"</span>: <span class="st">"INDIANA"</span>},</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>            columns<span class="op">=</span>{<span class="st">"three"</span>: <span class="st">"peekaboo"</span>})</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Current state data: </span><span class="ch">\n</span><span class="st">"</span>, data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Original some states data frame: 
           one  two  three  four
ohio        0    1      2     3
colorado    4    5      6     7
new york    8    9     10    11

Transforming index labels in place:  
           one  two  three  four
ohio        0    1      2     3
colorado    4    5      6     7
new york    8    9     10    11
Transforming axis index labels in a new data frame, passing functions, dictionary..

Current state data: 
       one  two  three  four
OHIO    0    1      2     3
COLO    4    5      6     7
NEW     8    9     10    11</code></pre>
</div>
</div>
</section>
<section id="discretization-and-binning" class="level3">
<h3 class="anchored" data-anchor-id="discretization-and-binning">2.5 Discretization and Binning</h3>
<p>Discretization and binning refer to the process of converting continuous numerical data into discrete internals and bins. In data analysis, discretization and binning are often required to simplify the data, make it more manageable, and faciliate analysis. <code>pandas.cut</code>:</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample age bucket data</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>ages <span class="op">=</span> [<span class="dv">20</span>, <span class="dv">22</span>, <span class="dv">25</span>, <span class="dv">27</span>, <span class="dv">21</span>, <span class="dv">23</span>, <span class="dv">37</span>, <span class="dv">31</span>, <span class="dv">61</span>, <span class="dv">45</span>, <span class="dv">41</span>, <span class="dv">32</span>]</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Binning the data - 18-25, 26-35, 36-60, 61+</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>bins <span class="op">=</span> [<span class="dv">18</span>, <span class="dv">25</span>, <span class="dv">35</span>, <span class="dv">60</span>, <span class="dv">100</span>]</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>age_categories <span class="op">=</span> pd.cut(ages, bins)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>age_categories.codes</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>age_categories.categories</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>age_categories.categories[<span class="dv">0</span>]</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>pd.value_counts(age_categories)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>(18, 25]     5
(25, 35]     3
(35, 60]     3
(60, 100]    1
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.random.uniform(size<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>data</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>pd.cut(data, <span class="dv">4</span>, precision<span class="op">=</span><span class="dv">2</span>)  <span class="co"># 4 of equal-length bins</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>[(0.29, 0.52], (0.29, 0.52], (0.75, 0.99], (0.053, 0.29], (0.75, 0.99], ..., (0.053, 0.29], (0.75, 0.99], (0.29, 0.52], (0.52, 0.75], (0.75, 0.99]]
Length: 20
Categories (4, interval[float64, right]): [(0.053, 0.29] &lt; (0.29, 0.52] &lt; (0.52, 0.75] &lt; (0.75, 0.99]]</code></pre>
</div>
</div>
<p>Binning with quartiles: <code>pandas.qcut</code></p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1000 random float64 numbers in standard normal dist.</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.random.standard_normal(<span class="dv">1000</span>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>quartiles <span class="op">=</span> pd.qcut(data, <span class="dv">4</span>, precision<span class="op">=</span><span class="dv">2</span>)  <span class="co"># 4 bins using quantile info of data</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(quartiles, <span class="bu">type</span>(quartiles))</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>pd.value_counts(quartiles)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Binning with custom quantiles between 0 - 1:"</span>)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>pd.qcut(data, [<span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>, <span class="fl">1.</span>]).value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[(-3.98, -0.6], (-0.6, 0.058], (-3.98, -0.6], (-0.6, 0.058], (-0.6, 0.058], ..., (0.63, 2.98], (-0.6, 0.058], (0.058, 0.63], (-0.6, 0.058], (0.63, 2.98]]
Length: 1000
Categories (4, interval[float64, right]): [(-3.98, -0.6] &lt; (-0.6, 0.058] &lt; (0.058, 0.63] &lt; (0.63, 2.98]] &lt;class 'pandas.core.arrays.categorical.Categorical'&gt;
Binning with custom quantiles between 0 - 1:</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>(-3.969, -1.213]    100
(-1.213, 0.0581]    400
(0.0581, 1.311]     400
(1.311, 2.977]      100
dtype: int64</code></pre>
</div>
</div>
</section>
<section id="detecting-and-filtering-outliers" class="level3">
<h3 class="anchored" data-anchor-id="detecting-and-filtering-outliers">2.6 Detecting and Filtering Outliers</h3>
<p>Largely a matter of applying array operations.</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Describe the sample data frame in 1000 x 4 shape</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.DataFrame(np.random.standard_normal((<span class="dv">1000</span>, <span class="dv">4</span>)))</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"--- Original sample data frame of 1000 x 4: </span><span class="ch">\n</span><span class="st">"</span>, data)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"--- Describe the sample data frame in 1000 x 4 shape: </span><span class="ch">\n</span><span class="st">"</span>, data.describe())</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtering elements in column '2' with absolute value &gt; 3:</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>col <span class="op">=</span> data[<span class="dv">2</span>] <span class="co"># colum 2</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"--- Display heads of column '2': </span><span class="ch">\n</span><span class="st">"</span>, col.head())</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"--- Filtering elements with absolute value &gt; 3: </span><span class="ch">\n</span><span class="st">"</span>, col[col.<span class="bu">abs</span>() <span class="op">&gt;</span> <span class="dv">3</span>]) <span class="co"># filtering</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Select ALL ROWS with any element containing absolute value &gt; 3</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"--- Select ALL ROWS with any element containing absolute value &gt; 3: "</span>)</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data[(data.<span class="bu">abs</span>() <span class="op">&gt;</span> <span class="dv">3</span>).<span class="bu">any</span>(axis<span class="op">=</span><span class="st">"columns"</span>)])  <span class="co"># Set axis parameter to columns to make row-based filtering</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>data.tail(<span class="dv">30</span>)</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--- Original sample data frame of 1000 x 4: 
             0         1         2         3
0    1.407498  0.579955  0.318191  0.373293
1   -0.926634 -0.611101 -0.443350 -1.739187
2    0.639597 -0.068382  0.718472 -1.130073
3   -0.089489 -1.197352  0.355320 -1.095180
4    0.441899 -0.055579  1.906773  2.014264
..        ...       ...       ...       ...
995  0.409653 -0.744040  0.429761  2.266320
996 -0.067480  1.677813 -0.167166  1.050424
997 -1.023779 -0.319502  0.871737  0.409182
998 -1.832325 -0.265668  0.017586  0.426614
999 -0.009098  0.589416 -1.399545  2.030039

[1000 rows x 4 columns]
--- Describe the sample data frame in 1000 x 4 shape: 
                  0            1            2            3
count  1000.000000  1000.000000  1000.000000  1000.000000
mean     -0.009183     0.029173     0.004915     0.062535
std       0.989200     0.967977     0.956451     1.020223
min      -3.275011    -3.035883    -3.492354    -3.354237
25%      -0.660060    -0.624276    -0.613096    -0.624135
50%      -0.040555     0.014348     0.030848     0.074224
75%       0.652973     0.693571     0.589122     0.772864
max       2.881007     3.278446     3.201319     3.147918
--- Display heads of column '2': 
 0    0.318191
1   -0.443350
2    0.718472
3    0.355320
4    1.906773
Name: 2, dtype: float64
--- Filtering elements with absolute value &gt; 3: 
 98     3.201319
183   -3.492354
Name: 2, dtype: float64
--- Select ALL ROWS with any element containing absolute value &gt; 3: 
            0         1         2         3
76   0.558298  1.635638  1.132034 -3.023185
98   0.937477 -0.463511  3.201319 -0.180321
165  0.679715  3.278446  1.066659  1.073756
183 -0.667685  0.283453 -3.492354  1.104043
201  1.619332 -0.252212 -0.129636  3.147918
302 -0.418741 -3.035883  0.117048  0.455650
534 -2.216378 -0.168824 -1.066255 -3.354237
715 -3.275011 -0.775129 -1.613530  0.735559
989  0.747609 -3.001891 -1.061821 -0.417744</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="17">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1.407498</td>
<td>0.579955</td>
<td>0.318191</td>
<td>0.373293</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-0.926634</td>
<td>-0.611101</td>
<td>-0.443350</td>
<td>-1.739187</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.639597</td>
<td>-0.068382</td>
<td>0.718472</td>
<td>-1.130073</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>-0.089489</td>
<td>-1.197352</td>
<td>0.355320</td>
<td>-1.095180</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.441899</td>
<td>-0.055579</td>
<td>1.906773</td>
<td>2.014264</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">995</td>
<td>0.409653</td>
<td>-0.744040</td>
<td>0.429761</td>
<td>2.266320</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">996</td>
<td>-0.067480</td>
<td>1.677813</td>
<td>-0.167166</td>
<td>1.050424</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">997</td>
<td>-1.023779</td>
<td>-0.319502</td>
<td>0.871737</td>
<td>0.409182</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">998</td>
<td>-1.832325</td>
<td>-0.265668</td>
<td>0.017586</td>
<td>0.426614</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">999</td>
<td>-0.009098</td>
<td>0.589416</td>
<td>-1.399545</td>
<td>2.030039</td>
</tr>
</tbody>
</table>

<p>1000 rows × 4 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data capping - Transfrom DataFrame by capping data range to certain values</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>data2 <span class="op">=</span> pd.DataFrame(np.random.standard_normal((<span class="dv">1000</span>, <span class="dv">4</span>)))</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>DATA_CAP <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Creating sample DF with 1000 x 4 dimension, standard normal dist.: </span><span class="ch">\n</span><span class="st">"</span>, data2)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"--- Describe the original data : </span><span class="ch">\n</span><span class="st">"</span>, data2.describe())</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>data2[data2.<span class="bu">abs</span>() <span class="op">&gt;</span> DATA_CAP] <span class="op">=</span> np.sign(data2) <span class="op">*</span> DATA_CAP  <span class="co"># Change in place, set the off limit element to DATA_CAP</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"--- Data transformed with DATA_CAP applied: </span><span class="ch">\n</span><span class="st">"</span>, data2)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"--- Describe the transformed data : </span><span class="ch">\n</span><span class="st">"</span>, data2.describe())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Creating sample DF with 1000 x 4 dimension, standard normal dist.: 
             0         1         2         3
0    0.514188  1.195679  0.757760  0.283861
1    0.070017  1.230087  0.509414  0.852981
2   -0.422204 -0.280746  0.433437  1.832664
3    1.374825 -0.617282  0.374333 -1.372530
4    0.145290 -1.422786  0.220729 -1.016823
..        ...       ...       ...       ...
995  0.935260 -0.118439  0.541348 -1.601415
996 -0.110730 -0.396774  0.649097  1.357872
997  1.385949  1.043180  0.921401 -1.132001
998 -1.690198 -2.162153  0.591353  0.257888
999 -0.329659  0.183763 -1.273946  1.489007

[1000 rows x 4 columns]
--- Describe the original data : 
                  0            1            2            3
count  1000.000000  1000.000000  1000.000000  1000.000000
mean     -0.035450    -0.034492    -0.032529    -0.020031
std       1.006872     0.984551     1.003461     1.040398
min      -2.768586    -3.294157    -3.392420    -3.903471
25%      -0.700575    -0.690578    -0.699771    -0.718212
50%      -0.029194    -0.041755     0.004529     0.011564
75%       0.662792     0.587990     0.676275     0.666776
max       3.209506     3.716015     3.028693     3.121175
--- Data transformed with DATA_CAP applied: 
             0         1         2         3
0    0.514188  1.195679  0.757760  0.283861
1    0.070017  1.230087  0.509414  0.852981
2   -0.422204 -0.280746  0.433437  1.832664
3    1.374825 -0.617282  0.374333 -1.372530
4    0.145290 -1.422786  0.220729 -1.016823
..        ...       ...       ...       ...
995  0.935260 -0.118439  0.541348 -1.601415
996 -0.110730 -0.396774  0.649097  1.357872
997  1.385949  1.043180  0.921401 -1.132001
998 -1.690198 -2.162153  0.591353  0.257888
999 -0.329659  0.183763 -1.273946  1.489007

[1000 rows x 4 columns]
--- Describe the transformed data : 
                  0            1            2            3
count  1000.000000  1000.000000  1000.000000  1000.000000
mean     -0.035840    -0.034721    -0.032165    -0.018111
std       1.005658     0.980275     1.002135     1.033490
min      -2.768586    -3.000000    -3.000000    -3.000000
25%      -0.700575    -0.690578    -0.699771    -0.718212
50%      -0.029194    -0.041755     0.004529     0.011564
75%       0.662792     0.587990     0.676275     0.666776
max       3.000000     3.000000     3.000000     3.000000</code></pre>
</div>
</div>
</section>
<section id="permutation-and-random-sampling" class="level3">
<h3 class="anchored" data-anchor-id="permutation-and-random-sampling">2.7 Permutation and Random Sampling</h3>
<p>Permutation and random sampling are techniques used in data analysis for different purposes. Understanding these techniques is crucial for ensuring the reliability and generalizability of statistical analyses and making informed decisions based on data.</p>
<p><strong>Permutation:</strong> Permutation refers to the arrangement of elements in a specific order. In Data Analysis,permutation is often used in permutation tests or resampling methods. Permutation tests involve randomly reordering the observed data to create a null distribution under the assumption that there is no effect or difference.</p>
<p><strong>Common Use Cases:</strong></p>
<ul>
<li>Comparing two groups to assess if the observed difference is statistically significant.</li>
<li>Testing hypotheses when assumptions of traditional statistical tests are not met.</li>
</ul>
<p><strong>Random Sampling:</strong> Random sampling involves selecting a subset of data points from a larger dataset in a way that each data point has an equal chance of being chosen. In Data Analysis: Random sampling is fundamental in creating representative samples from a population, and it is commonly used in inferential statistics to make predictions or inferences about a population based on a sample.</p>
<p><strong>Common Use Cases:</strong></p>
<ul>
<li>Conducting surveys to gather opinions from a diverse population.</li>
<li>Estimating population parameters using a sample.</li>
</ul>
<p><strong>Importance:</strong></p>
<ul>
<li><strong>Statistical Validity:</strong> Both permutation and random sampling contribute to the statistical validity of analyses. Permutation tests provide a non-parametric approach to hypothesis testing, while random sampling ensures that collected samples are unbiased representations of the population.</li>
<li><strong>Robustness:</strong> Permutation tests can be more robust in certain situations, especially when assumptions of parametric tests are violated.</li>
<li><strong>Generalization:</strong> Random sampling allows for generalizing insights from a sample to a larger population, making statistical analyses more applicable in real-world scenarios.</li>
</ul>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a sample DF with integers, dimension of 5 x 7</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(np.arange(<span class="dv">5</span> <span class="op">*</span> <span class="dv">7</span>).reshape((<span class="dv">5</span>, <span class="dv">7</span>)))</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Original DF: </span><span class="ch">\n</span><span class="st">"</span>, df)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>sampler <span class="op">=</span> np.random.permutation(<span class="dv">5</span>)</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Array of new row index info. for permuting 5 rows: "</span>, sampler)</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder of row index using take()</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Reordering using take() : </span><span class="ch">\n</span><span class="st">"</span>, df.take(sampler)) <span class="co"># row index reordered</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder of row index using iloc[]</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Reordering using iloc: "</span>, df.iloc[sampler])</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>column_sampler <span class="op">=</span> np.random.permutation(<span class="dv">7</span>)</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"New orders: "</span>, column_sampler, <span class="bu">type</span>(column_sampler))</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder of column index</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Reordering columns with axis info: </span><span class="ch">\n</span><span class="st">"</span>, df.take(column_sampler, axis<span class="op">=</span><span class="st">"columns"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Original DF: 
     0   1   2   3   4   5   6
0   0   1   2   3   4   5   6
1   7   8   9  10  11  12  13
2  14  15  16  17  18  19  20
3  21  22  23  24  25  26  27
4  28  29  30  31  32  33  34
Array of new row index info. for permuting 5 rows:  [3 0 2 1 4]
Reordering using take() : 
     0   1   2   3   4   5   6
3  21  22  23  24  25  26  27
0   0   1   2   3   4   5   6
2  14  15  16  17  18  19  20
1   7   8   9  10  11  12  13
4  28  29  30  31  32  33  34
Reordering using iloc:      0   1   2   3   4   5   6
3  21  22  23  24  25  26  27
0   0   1   2   3   4   5   6
2  14  15  16  17  18  19  20
1   7   8   9  10  11  12  13
4  28  29  30  31  32  33  34
New orders:  [5 3 6 1 0 2 4] &lt;class 'numpy.ndarray'&gt;
Reordering columns with axis info: 
     5   3   6   1   0   2   4
0   5   3   6   1   0   2   4
1  12  10  13   8   7   9  11
2  19  17  20  15  14  16  18
3  26  24  27  22  21  23  25
4  33  31  34  29  28  30  32</code></pre>
</div>
</div>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># random subset without replacement - same row cannot appear twice</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(np.arange(<span class="dv">5</span> <span class="op">*</span> <span class="dv">7</span>).reshape((<span class="dv">5</span>, <span class="dv">7</span>)))</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"--- Original sample DF: </span><span class="ch">\n</span><span class="st">"</span>, df)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"--- Random sampling of N rows, Must N &lt; total rows: "</span>)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>df.sample(n<span class="op">=</span><span class="dv">3</span>)  <span class="co"># random selection of n rows in random order, n must be less than the number of rows</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co"># random subset with replacement - allow repeat choices</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>choices <span class="op">=</span> pd.Series([<span class="dv">5</span>, <span class="dv">7</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">4</span>])</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"--- Original Series data. </span><span class="ch">\n</span><span class="st">"</span>, choices)  <span class="co"># allow repeated selections</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"--- Random sampling of N, repeating allowed."</span>)</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>choices.sample(n<span class="op">=</span><span class="dv">10</span>, replace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--- Original sample DF: 
     0   1   2   3   4   5   6
0   0   1   2   3   4   5   6
1   7   8   9  10  11  12  13
2  14  15  16  17  18  19  20
3  21  22  23  24  25  26  27
4  28  29  30  31  32  33  34
--- Random sampling of N rows, Must N &lt; total rows: 
--- Original Series data. 
 0    5
1    7
2   -1
3    6
4    4
dtype: int64
--- Random sampling of N, repeating allowed.</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>4    4
3    6
0    5
1    7
3    6
4    4
0    5
2   -1
2   -1
0    5
dtype: int64</code></pre>
</div>
</div>
</section>
<section id="computing-indicatordummy-variables" class="level3">
<h3 class="anchored" data-anchor-id="computing-indicatordummy-variables">2.8 Computing Indicator/Dummy Variables</h3>
<p>Common type of transformation for machine learning applications / statistical modeling, converting a categorical variable into a dummy/indicator matrix. Convert a columsn with number of distinct values: <code>k</code> into a data frame with <code>k</code> columns with 1s and 0s. <code>pandas.get_dummies</code></p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample data frame</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">"key"</span>: [<span class="st">"b"</span>, <span class="st">"b"</span>, <span class="st">"a"</span>, <span class="st">"c"</span>, <span class="st">"a"</span>, <span class="st">"b"</span>],</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"data1"</span>: <span class="bu">range</span>(<span class="dv">6</span>)})</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-- Sample data frame: </span><span class="ch">\n</span><span class="st">"</span>, df)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Get a matrix of dummy variables for the distinct values in column "key"</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-- A matrix of dummy variables for column </span><span class="ch">\"</span><span class="st">key</span><span class="ch">\"</span><span class="st">: "</span>)</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>dummies <span class="op">=</span> pd.get_dummies(df[<span class="st">"key"</span>], prefix<span class="op">=</span><span class="st">"key"</span>)  <span class="co"># adding prefix to the columns in matrix</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dummies)</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge with another / original data frame</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>df_with_dummy <span class="op">=</span> df[[<span class="st">"data1"</span>]].join(dummies)  <span class="co"># df[["data1"]].shape()</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-- Data frame merge: "</span>)</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>df_with_dummy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>-- Sample data frame: 
   key  data1
0   b      0
1   b      1
2   a      2
3   c      3
4   a      4
5   b      5
-- A matrix of dummy variables for column "key": 
   key_a  key_b  key_c
0      0      1      0
1      0      1      0
2      1      0      0
3      0      0      1
4      1      0      0
5      0      1      0
-- Data frame merge: </code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="21">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">data1</th>
<th data-quarto-table-cell-role="th">key_a</th>
<th data-quarto-table-cell-role="th">key_b</th>
<th data-quarto-table-cell-role="th">key_c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>5</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Handling rows belong to multiple categpries</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># MovieLens 1M dataset</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Read general delimited files into DF</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>mnames <span class="op">=</span> [<span class="st">"movie_id"</span>, <span class="st">"title"</span>, <span class="st">"genres"</span>]</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>movies <span class="op">=</span> pd.read_table(<span class="st">"../data/movielens/movies.dat"</span>,</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>                       sep<span class="op">=</span><span class="st">"::"</span>,</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>                       header<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>                       names<span class="op">=</span>mnames,</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>                       engine<span class="op">=</span><span class="st">"python"</span>)  </span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-- Some movie data.. "</span>)</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>movies[:<span class="dv">10</span>]</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Get dummy variables on a column with multiple categorical values</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-- Some dummy variables on Series 'genre', using str.get_dummies:"</span>)</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>dummies <span class="op">=</span> movies[<span class="st">"genres"</span>].<span class="bu">str</span>.get_dummies(<span class="st">"|"</span>)</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>dummies.iloc[:<span class="dv">10</span>, :<span class="dv">6</span>]</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge dummy variables with original data </span></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>movies_windic <span class="op">=</span> movies.join(dummies.add_prefix(<span class="st">"Genre_"</span>))</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-- Movie data merged with dummy variables:"</span>)</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>movies_windic.head()</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-- Single movie data row:"</span>)</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>movies_windic.iloc[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>-- Some movie data.. 
-- Some dummy variables on Series 'genre', using str.get_dummies:
-- Movie data merged with dummy variables:
-- Single movie data row:</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>movie_id                                       1
title                           Toy Story (1995)
genres               Animation|Children's|Comedy
Genre_Action                                   0
Genre_Adventure                                0
Genre_Animation                                1
Genre_Children's                               1
Genre_Comedy                                   1
Genre_Crime                                    0
Genre_Documentary                              0
Genre_Drama                                    0
Genre_Fantasy                                  0
Genre_Film-Noir                                0
Genre_Horror                                   0
Genre_Musical                                  0
Genre_Mystery                                  0
Genre_Romance                                  0
Genre_Sci-Fi                                   0
Genre_Thriller                                 0
Genre_War                                      0
Genre_Western                                  0
Name: 0, dtype: object</code></pre>
</div>
</div>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create uniform sample data (repeatable)</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">12345</span>)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>values <span class="op">=</span> np.random.uniform(size<span class="op">=</span><span class="dv">10</span>)  <span class="co"># All values are equally likely to be generated.</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-- Sample random values in uniform distribution: </span><span class="ch">\n</span><span class="st">"</span>, values, <span class="bu">type</span>(values))</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Binning the values</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>bins <span class="op">=</span> [<span class="dv">0</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="dv">1</span>]  <span class="co"># bin edges to cut the values into</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>values_bins <span class="op">=</span> pd.cut(values, bins)  <span class="co"># categorical value mapping </span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-- Value - bin: </span><span class="ch">\n</span><span class="st">"</span>, values_bins, <span class="bu">type</span>(values_bins))</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Get dummy variabels for the categorical bins</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-- Dummy variables of the categorical bins with sample values: </span><span class="ch">\n</span><span class="st">"</span>, pd.get_dummies(values_bins))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>-- Sample random values in uniform distribution: 
 [0.92961609 0.31637555 0.18391881 0.20456028 0.56772503 0.5955447
 0.96451452 0.6531771  0.74890664 0.65356987] &lt;class 'numpy.ndarray'&gt;
-- Value - bin: 
 [(0.8, 1.0], (0.2, 0.4], (0.0, 0.2], (0.2, 0.4], (0.4, 0.6], (0.4, 0.6], (0.8, 1.0], (0.6, 0.8], (0.6, 0.8], (0.6, 0.8]]
Categories (5, interval[float64, right]): [(0.0, 0.2] &lt; (0.2, 0.4] &lt; (0.4, 0.6] &lt; (0.6, 0.8] &lt; (0.8, 1.0]] &lt;class 'pandas.core.arrays.categorical.Categorical'&gt;
-- Dummy variables of the categorical bins with sample values: 
    (0.0, 0.2]  (0.2, 0.4]  (0.4, 0.6]  (0.6, 0.8]  (0.8, 1.0]
0           0           0           0           0           1
1           0           1           0           0           0
2           1           0           0           0           0
3           0           1           0           0           0
4           0           0           1           0           0
5           0           0           1           0           0
6           0           0           0           0           1
7           0           0           0           1           0
8           0           0           0           1           0
9           0           0           0           1           0</code></pre>
</div>
</div>
<p>Pandas Extended Data Types</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="co"># category Data Type</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame with a categorical column</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'Category'</span>: [<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'A'</span>, <span class="st">'C'</span>]})</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-- Origianl sample data: </span><span class="ch">\n</span><span class="st">"</span>, df)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Category'</span>]</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-- Convert to type - category on Category column: </span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Category'</span>] <span class="op">=</span> df[<span class="st">'Category'</span>].astype(<span class="st">'category'</span>)</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Category'</span>]</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Nullable Integer Data Types, to allow and handle missing values NaN</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame with a nullable integer column</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'IntegerColumn'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="va">None</span>, <span class="dv">4</span>],</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'AnotherColumn'</span>: [<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>, <span class="st">'D'</span>]})</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-- Original sample DF: </span><span class="ch">\n</span><span class="st">"</span>, df)</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"df['IntegerColumn]: </span><span class="ch">\n</span><span class="st">"</span>, df[<span class="st">'IntegerColumn'</span>])  <span class="co"># With None, converts to float64 and NaN</span></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-- IntegerColumn astype Int64: "</span>)</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'IntegerColumn'</span>] <span class="op">=</span> df[<span class="st">'IntegerColumn'</span>].astype(<span class="st">'Int64'</span>)  <span class="co"># Keep integers and change None to &lt;NA&gt;</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'IntegerColumn'</span>]</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a><span class="co"># StringDtype, allowing string data and missing data within string columns.</span></span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a><span class="co"># DF with a string colum</span></span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'StringColumn'</span>: [<span class="st">'apple'</span>, <span class="st">'banana'</span>, <span class="va">None</span>, <span class="st">'oragne'</span>]})</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-- Original DF: </span><span class="ch">\n</span><span class="st">"</span>, df)</span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"StringColumn: </span><span class="ch">\n</span><span class="st">"</span>, df[<span class="st">'StringColumn'</span>], <span class="bu">type</span>(df[<span class="st">'StringColumn'</span>]))</span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'StringColumn'</span>] <span class="op">=</span> df[<span class="st">'StringColumn'</span>].astype(<span class="st">'string'</span>)</span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"StringColumn with astype(string): </span><span class="ch">\n</span><span class="st">"</span>, df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>-- Origianl sample data: 
   Category
0        A
1        B
2        A
3        C
-- Convert to type - category on Category column: 

-- Original sample DF: 
    IntegerColumn AnotherColumn
0            1.0             A
1            2.0             B
2            NaN             C
3            4.0             D
df['IntegerColumn]: 
 0    1.0
1    2.0
2    NaN
3    4.0
Name: IntegerColumn, dtype: float64
-- IntegerColumn astype Int64: 
-- Original DF: 
   StringColumn
0        apple
1       banana
2         None
3       oragne
StringColumn: 
 0     apple
1    banana
2      None
3    oragne
Name: StringColumn, dtype: object &lt;class 'pandas.core.series.Series'&gt;
StringColumn with astype(string): 
   StringColumn
0        apple
1       banana
2         &lt;NA&gt;
3       oragne</code></pre>
</div>
</div>
<p>Helper functions.</p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper functions</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function to transform data frame with capped value</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> data_cap(data, condition, cap_value):</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  data[condition] <span class="op">=</span> np.sign(data) <span class="op">*</span> cap_value</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.DataFrame(np.random.standard_normal((<span class="dv">100</span>, <span class="dv">4</span>)))</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"--- Creating sample DF with 100 x 4 dimension, standard normal dist.: </span><span class="ch">\n</span><span class="st">"</span>, data)</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"--- Describing the original data : </span><span class="ch">\n</span><span class="st">"</span>, data.describe())</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>DATA_CAP_VALUE <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>data_cap(data, data.<span class="bu">abs</span>() <span class="op">&gt;</span> DATA_CAP_VALUE, DATA_CAP_VALUE)</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"--- Display and describing the transformed data with capped value: </span><span class="ch">\n</span><span class="st">"</span>, data, <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>, data.describe())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--- Creating sample DF with 100 x 4 dimension, standard normal dist.: 
            0         1         2         3
0   1.007189 -1.296221  0.274992  0.228913
1   1.352917  0.886429 -2.001637 -0.371843
2   1.669025 -0.438570 -0.539741  0.476985
3   3.248944 -1.021228 -0.577087  0.124121
4   0.302614  0.523772  0.000940  1.343810
..       ...       ...       ...       ...
95  0.106061  3.927528 -0.255126  0.854137
96 -0.364807  0.131102 -0.697614  1.335649
97 -0.151039  0.442938  0.941571  0.533364
98  0.356266 -0.010115  1.415753  0.566106
99  0.456487  0.194788 -0.655054 -0.565230

[100 rows x 4 columns]
--- Describing the original data : 
                 0           1           2           3
count  100.000000  100.000000  100.000000  100.000000
mean     0.075414   -0.072037   -0.151045    0.073887
std      1.056971    1.099638    0.988262    0.905969
min     -2.644409   -2.420294   -2.557934   -1.860761
25%     -0.699515   -0.773203   -0.788723   -0.571684
50%      0.073201   -0.189255   -0.261119    0.090167
75%      0.730487    0.624688    0.637665    0.649135
max      3.248944    3.927528    2.212303    2.613999
--- Display and describing the transformed data with capped value: 
            0         1         2         3
0   1.000000 -1.000000  0.274992  0.228913
1   1.000000  0.886429 -1.000000 -0.371843
2   1.000000 -0.438570 -0.539741  0.476985
3   1.000000 -1.000000 -0.577087  0.124121
4   0.302614  0.523772  0.000940  1.000000
..       ...       ...       ...       ...
95  0.106061  1.000000 -0.255126  0.854137
96 -0.364807  0.131102 -0.697614  1.000000
97 -0.151039  0.442938  0.941571  0.533364
98  0.356266 -0.010115  1.000000  0.566106
99  0.456487  0.194788 -0.655054 -0.565230

[100 rows x 4 columns] 
                 0           1           2           3
count  100.000000  100.000000  100.000000  100.000000
mean     0.050169   -0.073364   -0.113546    0.037149
std      0.731434    0.750175    0.728088    0.713627
min     -1.000000   -1.000000   -1.000000   -1.000000
25%     -0.699515   -0.773203   -0.788723   -0.571684
50%      0.073201   -0.189255   -0.261119    0.090167
75%      0.730487    0.624688    0.637665    0.649135
max      1.000000    1.000000    1.000000    1.000000</code></pre>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Copyright 2023, Albert Joonyoung Park.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>



</body></html>